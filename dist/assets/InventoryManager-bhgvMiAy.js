import{c as ze,p as es,q as ts,u as ar,t as Ta,r as y,j as e,i as W,l as tt,v as ut,n as he,o as mr,w as La,x as xt,a as pr,y as rs,s as q,R as ht,z as as,X as fr,E as Sr,A as ct,C as ss,P as er,D as ns,F as ls,G as vr,H as os,h as Aa,B as ir,I as dr,T as Cr}from"./index-KWh3gr5N.js";import{B as Ra,c as is}from"./BarcodeScannerModal-CZKAf02u.js";import{g as je}from"./categoryColors-BepW_45H.js";import{r as ds,u as Ue,w as $a}from"./xlsx-BBWTpfDg.js";import{u as cs,a as kr,C as us,b as hs,c as Ia}from"./CategoriesManager-CQo1bPhl.js";import xs from"./LookupManager-BNscX6hO.js";import{u as ms,a as fs,b as bs}from"./useInventoryTransactionsRepository-DgAYHjE8.js";import{b as Da}from"./useDebtsRepository-B0Jo08Tn.js";import{v as br}from"./validation-CmPBxZwi.js";import{P as rr}from"./printer-DbNJ_4ek.js";import{M as gs}from"./minus-cfzubs0l.js";import{P as tr}from"./plus-Cs910NQ_.js";import"./Icons-eB76mjxX.js";import"./palette-DKNpV5TW.js";import"./cog-fTyz27yV.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=ze("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=ze("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=ze("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=ze("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=ze("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=ze("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=ze("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),js=(d,f,b="inventory-export.xlsx")=>{const i=d.map((x,h)=>{var l;return{STT:h+1,"T√™n s·∫£n ph·∫©m":x.name,SKU:x.sku,"Danh m·ª•c":x.category||"","T·ªìn kho":x.stock[f]||0,"Gi√° b√°n l·∫ª":x.retailPrice[f]||0,"Gi√° b√°n s·ªâ":((l=x.wholesalePrice)==null?void 0:l[f])||0,"Gi√° tr·ªã t·ªìn":(x.stock[f]||0)*(x.retailPrice[f]||0),"M√¥ t·∫£":x.description||""}}),c=Ue.json_to_sheet(i);c["!cols"]=[{wch:5},{wch:30},{wch:15},{wch:20},{wch:10},{wch:15},{wch:15},{wch:15},{wch:40}];const m=Ue.book_new();Ue.book_append_sheet(m,c,"T·ªìn kho"),$a(m,b)},ws=(d="inventory-template.xlsx")=>{const f=[{"T√™n s·∫£n ph·∫©m":"VD: Nh·ªõt Motul 7100 10W40",SKU:"A3B7K9M2 (ho·∫∑c ƒë·ªÉ tr·ªëng - h·ªá th·ªëng t·ª± t·∫°o)","Danh m·ª•c":"Nh·ªõt ƒë·ªông c∆°","S·ªë l∆∞·ª£ng nh·∫≠p":50,"Gi√° b√°n l·∫ª":18e4,"Gi√° b√°n s·ªâ":15e4,"M√¥ t·∫£":"Nh·ªõt cao c·∫•p cho xe c√¥n tay"}],b=Ue.json_to_sheet(f);b["!cols"]=[{wch:30},{wch:15},{wch:20},{wch:15},{wch:15},{wch:15},{wch:40}];const i=Ue.book_new();Ue.book_append_sheet(i,b,"Template"),$a(i,d)},Ns=(d,f)=>new Promise((b,i)=>{const c=new FileReader;c.onload=m=>{var x;try{const h=(x=m.target)==null?void 0:x.result,l=/\.csv$/i.test(d.name),t=ds(h,{type:l?"string":"binary"}),r=t.SheetNames[0],s=t.Sheets[r],a=Ue.sheet_to_json(s,{defval:"",blankrows:!1}),n=E=>E.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/ƒë/gi,O=>O==="ƒë"?"d":"D"),o=E=>n(String(E).toLowerCase().trim()).replace(/[^a-z0-9]+/g,""),u=E=>{if(E==null||E==="")return 0;if(typeof E=="number")return E;let O=String(E).trim();O=O.replace(/\s+/g,""),O.includes(".")&&O.includes(",")?O=O.replace(/\./g,"").replace(/,/g,"."):O.includes(",")&&!O.includes(".")?O=O.replace(/,/g,"."):O=O.replace(/,/g,"");const B=parseFloat(O);return isNaN(B)?0:B},g={name:["tensanpham","ten","productname","name","tenhang","tenmh"],sku:["sku","mahang","mah","code","ma","masp","mavt"],category:["danhmuc","nhom","loai","category"],quantity:["soluongnhap","soluong","ton","tonkho","sl","qty"],costPrice:["dongianhap","gianhap","costprice","giavon"],retailPrice:["giabanle","giale","giaban","gia","retailprice","giabanra","dongiabanle"],wholesalePrice:["giabansi","giasi","wholesaleprice","giabuon","dongiabansi"],description:["mota","ghichu","note","description"]},k=[],v=a.map((E,O)=>{const B=E||{},w={};Object.keys(B).forEach(H=>{w[o(H)]=B[H]});const C=(H,te)=>{for(const ce of g[H]){const de=w[ce];if(de!=null&&de!=="")return de}return te},_=String(C("name","")).trim();let S=String(C("sku","")).trim().toUpperCase();(!S||!es(S))&&(S=ts(),console.log(`üîÑ Generated SKU for "${_}": ${S}`));const M=C("category"),L=u(C("quantity",0)),P=u(C("costPrice",0)),D=u(C("retailPrice",0)),$=u(C("wholesalePrice",0)),z=C("description");if(!_&&Object.values(B).some(H=>H!=="")){const H=Object.values(B).map(te=>String(te).trim()).filter(te=>te!=="");if(H.length>0&&H[0].length>0)return k.push(`H√†ng ${O+2}: Thi·∫øu t√™n s·∫£n ph·∫©m, t·∫°o SKU: ${S}`),null}return _?{name:_,sku:S,category:M,quantity:L,costPrice:P,retailPrice:D,wholesalePrice:$,description:z}:null}).filter(Boolean);b({items:v,errors:k})}catch(h){const l=h instanceof Error?h.message:"Kh√¥ng ƒë·ªçc ƒë∆∞·ª£c d·ªØ li·ªáu";i(new Error(l))}},c.onerror=()=>{i(new Error("L·ªói ƒë·ªçc file"))},/\.csv$/i.test(d.name)?c.readAsText(d,"utf-8"):c.readAsBinaryString(d)}),_s=()=>{const{sales:d,workOrders:f,currentBranchId:b}=ar(),{data:i,isLoading:c}=Ta({page:1,pageSize:20}),m=(i==null?void 0:i.data)||[],[x,h]=y.useState(""),[l,t]=y.useState("all"),[r,s]=y.useState(null),[a,n]=y.useState("all"),[o,u]=y.useState(null),[g,k]=y.useState(!1),[v,E]=y.useState(!1),O=y.useMemo(()=>{const _=new Set;return m.forEach(S=>{S.category&&_.add(S.category)}),Array.from(_).sort()},[m]),B=y.useMemo(()=>m.filter(_=>{var M,L;if(x){const P=x.toLowerCase(),D=_.name.toLowerCase().includes(P),$=(M=_.sku)==null?void 0:M.toLowerCase().includes(P),z=(L=_.description)==null?void 0:L.toLowerCase().includes(P);if(!D&&!$&&!z)return!1}if(l!=="all"&&_.category!==l)return!1;if(r){const P=_.retailPrice[b]||0;if(P<r.min||P>r.max)return!1}const S=_.stock[b]||0;return!(a==="in-stock"&&S<=0||a==="low-stock"&&S>10||a==="out-of-stock"&&S>0)}),[m,x,l,r,a,b]),C=o?(_=>{const S=m.find($=>$.id===_);if(!S)return null;const M=d.filter($=>$.items.some(z=>z.partId===_)),L=f.filter($=>{var z;return(z=$.partsUsed)==null?void 0:z.some(H=>H.partId===_)}),P=M.reduce(($,z)=>{const H=z.items.find(te=>te.partId===_);return $+((H==null?void 0:H.quantity)||0)},0),D=M.reduce(($,z)=>{const H=z.items.find(te=>te.partId===_);return $+((H==null?void 0:H.sellingPrice)||0)*((H==null?void 0:H.quantity)||0)},0);return{part:S,salesCount:M.length,totalSold:P,revenue:D,lastSold:M.length>0?M.sort(($,z)=>new Date(z.date).getTime()-new Date($.date).getTime())[0].date:null,workOrdersCount:L.length}})(o):null;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-[#0f172a]",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white dark:bg-[#1e293b] border-b border-slate-200 dark:border-slate-700 p-3 space-y-2",children:[e.jsx("input",{type:"text",value:x,onChange:_=>h(_.target.value),placeholder:"T√¨m s·∫£n ph·∫©m...",className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 placeholder-slate-400 text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>k(!0),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"B·ªô l·ªçc"]}),e.jsxs("div",{className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:[B.length," sp"]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:B.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsxs("svg",{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c t·ª´ kh√≥a t√¨m ki·∫øm"})]}):e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:B.map(_=>{const S=_.stock[b]||0,M=_.retailPrice[b]||0;return e.jsxs("button",{onClick:()=>{u(_.id),E(!0)},className:"w-full p-4 flex items-center gap-3 bg-white dark:bg-[#1e293b] hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100 truncate",children:_.name}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:["SKU: ",_.sku]}),_.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-medium mt-0.5 ${je(_.category).bg} ${je(_.category).text}`,children:_.category})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-base font-bold text-blue-600 dark:text-blue-400",children:W(M)}),e.jsx("div",{className:"flex items-center gap-1 justify-end mt-1",children:S<=0?e.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs rounded",children:"H·∫øt"}):S<=10?e.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-xs rounded",children:S}):e.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-xs rounded",children:S})})]})]},_.id)})})})]}),g&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>k(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"B·ªô l·ªçc t√¨m ki·∫øm"}),e.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Danh m·ª•c"}),e.jsxs("select",{value:l,onChange:_=>t(_.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),O.map(_=>e.jsx("option",{value:_,children:_},_))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"T·ªìn kho"}),e.jsx("div",{className:"space-y-2",children:[{value:"all",label:"T·∫•t c·∫£"},{value:"in-stock",label:"C√≤n h√†ng"},{value:"low-stock",label:"S·∫Øp h·∫øt (‚â§10)"},{value:"out-of-stock",label:"H·∫øt h√†ng"}].map(_=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"stock",value:_.value,checked:a===_.value,onChange:S=>n(S.target.value),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:_.label})]},_.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Kho·∫£ng gi√°"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"T·ª´",onChange:_=>s(S=>({min:Number(_.target.value)||0,max:(S==null?void 0:S.max)||999999999})),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 text-sm"}),e.jsx("input",{type:"number",placeholder:"ƒê·∫øn",onChange:_=>s(S=>({min:(S==null?void 0:S.min)||0,max:Number(_.target.value)||999999999})),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 text-sm"})]}),r&&e.jsx("button",{onClick:()=>s(null),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"X√≥a b·ªô l·ªçc gi√°"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 flex gap-2",children:[e.jsx("button",{onClick:()=>{t("all"),n("all"),s(null)},className:"flex-1 px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:"ƒê·∫∑t l·∫°i"}),e.jsx("button",{onClick:()=>k(!1),className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium",children:"√Åp d·ª•ng"})]})]})]}),v&&C&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>E(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt s·∫£n ph·∫©m"}),e.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-1",children:C.part.name}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:["SKU: ",C.part.sku]}),C.part.category&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium mt-1.5 ${je(C.part.category).bg} ${je(C.part.category).text}`,children:C.part.category})]}),C.part.description&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"M√¥ t·∫£"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:C.part.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"T·ªìn kho"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:C.part.stock[b]||0})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Gi√° b√°n l·∫ª"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:W(C.part.retailPrice[b]||0)})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-3",children:"Th·ªëng k√™ b√°n h√†ng"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1",children:"T·ªïng ƒë√£ b√°n"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:C.totalSold})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-emerald-600 dark:text-emerald-400 mb-1",children:"Doanh thu"}),e.jsx("div",{className:"text-xl font-bold text-emerald-900 dark:text-emerald-100",children:W(C.revenue)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/20 dark:to-amber-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-amber-600 dark:text-amber-400 mb-1",children:"S·ªë ƒë∆°n h√†ng"}),e.jsx("div",{className:"text-2xl font-bold text-amber-900 dark:text-amber-100",children:C.salesCount})]}),C.lastSold&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"B√°n g·∫ßn nh·∫•t"}),e.jsx("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:tt(C.lastSold)})]})]})]})]})]})]})]})},gr="suppliers";async function Ss(){try{const{data:d,error:f}=await he.from(gr).select("*").order("name");return f?ut({code:"supabase",message:"Kh√¥ng th·ªÉ t·∫£i nh√† cung c·∫•p",cause:f}):La(d||[])}catch(d){return ut({code:"network",message:"L·ªói k·∫øt n·ªëi",cause:d})}}async function Cs(d){var f;try{if(!d.name)return ut({code:"validation",message:"Thi·∫øu t√™n nh√† cung c·∫•p"});const b={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Math.random().toString(36).slice(2)}-${Date.now()}`,name:d.name,phone:d.phone,address:d.address,created_at:new Date().toISOString()},{data:i,error:c}=await he.from(gr).insert([b]).select().single();if(c||!i){const x=(c==null?void 0:c.message)||(c==null?void 0:c.details)||"T·∫°o nh√† cung c·∫•p th·∫•t b·∫°i";return ut({code:"supabase",message:x,cause:c})}let m=null;try{const{data:x}=await he.auth.getUser();m=((f=x==null?void 0:x.user)==null?void 0:f.id)||null}catch{}return await mr(m,{action:"supplier.create",tableName:gr,recordId:i.id,oldData:null,newData:i}),La(i)}catch(b){return ut({code:"network",message:"L·ªói k·∫øt n·ªëi khi t·∫°o nh√† cung c·∫•p",cause:b})}}const yr=()=>xt({queryKey:["suppliers"],queryFn:async()=>{const d=await Ss();if(!d.ok)throw d.error;return d.data}}),qa=()=>{const d=pr();return rs({mutationFn:async f=>{const b=await Cs(f);if(!b.ok)throw b.error;return b.data},onSuccess:()=>{d.invalidateQueries({queryKey:["suppliers"]}),q.success("ƒê√£ th√™m nh√† cung c·∫•p")},onError:f=>q.error((f==null?void 0:f.message)||"L·ªói th√™m nh√† cung c·∫•p")})},cr=new Intl.NumberFormat("vi-VN",{minimumFractionDigits:0,maximumFractionDigits:2});function Es(d){let f=d.replace(/[^0-9.,-]/g,"");const b=f.includes("."),i=f.includes(",");b&&i?f=f.replace(/\./g,"").replace(",","."):i&&!b&&(f=f.replace(",","."));const c=Number(f);return Number.isFinite(c)?c:0}const qe=({value:d,onValue:f,placeholder:b,className:i,min:c,max:m,disabled:x,ariaLabel:h})=>{const[l,t]=ht.useState(d?cr.format(d):""),[r,s]=ht.useState(!1);ht.useEffect(()=>{r||t(d?cr.format(d):"")},[d,r]);const a=o=>{const u=o.target.value;t(u);const g=Es(u);if(c!==void 0&&g<c){f(c);return}if(m!==void 0&&g>m){f(m);return}f(g)},n=()=>{s(!1),t(d?cr.format(d):"")};return e.jsx("input",{type:"text",inputMode:"decimal",value:l,onChange:a,onFocus:()=>s(!0),onBlur:n,placeholder:b,className:i,disabled:x,"aria-label":h})},Ps=({isOpen:d,onClose:f,selectedSupplierId:b,onSelectSupplier:i})=>{const[c,m]=y.useState(""),[x,h]=y.useState(!1),{data:l=[]}=yr(),t=qa(),[r,s]=y.useState({name:"",phone:"",address:"",note:""}),a=l.filter(o=>{var g,k;const u=c.toLowerCase();return((g=o.name)==null?void 0:g.toLowerCase().includes(u))||((k=o.phone)==null?void 0:k.toLowerCase().includes(u))}),n=async()=>{if(!r.name.trim()){q.error("Vui l√≤ng nh·∫≠p t√™n nh√† cung c·∫•p");return}try{const o=await t.mutateAsync(r);q.success("ƒê√£ th√™m nh√† cung c·∫•p"),i(o.id),s({name:"",phone:"",address:"",note:""}),h(!1),f()}catch(o){q.error((o==null?void 0:o.message)||"L·ªói th√™m nh√† cung c·∫•p")}};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[110] flex items-end sm:items-center justify-center",onClick:f,children:e.jsxs("div",{onClick:o=>o.stopPropagation(),className:"bg-white dark:bg-slate-800 w-full sm:max-w-md h-[85vh] sm:h-auto sm:max-h-[80vh] rounded-t-3xl sm:rounded-xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:x?"Th√™m NCC m·ªõi":"Ch·ªçn nh√† cung c·∫•p"}),e.jsx("button",{onClick:f,className:"text-white text-2xl leading-none",children:"√ó"})]}),x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["T√™n nh√† cung c·∫•p ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:o=>s({...r,name:o.target.value}),placeholder:"Nh·∫≠p t√™n NCC",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"S·ªë ƒëi·ªán tho·∫°i"}),e.jsx("input",{type:"tel",inputMode:"numeric",value:r.phone,onChange:o=>s({...r,phone:o.target.value}),placeholder:"Nh·∫≠p SƒêT",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{value:r.address,onChange:o=>s({...r,address:o.target.value}),placeholder:"Nh·∫≠p ƒë·ªãa ch·ªâ",rows:3,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ghi ch√∫"}),e.jsx("textarea",{value:r.note,onChange:o=>s({...r,note:o.target.value}),placeholder:"Ghi ch√∫ th√™m",rows:2,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 resize-none"})]})]}),e.jsxs("div",{className:"p-3 border-t border-slate-200 dark:border-slate-700 flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>{h(!1),s({name:"",phone:"",address:"",note:""})},className:"flex-1 py-3 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-xl font-medium active:scale-98 transition-transform",children:"H·ªßy"}),e.jsx("button",{onClick:n,disabled:!r.name.trim()||t.isPending,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 dark:disabled:bg-slate-600 text-white rounded-xl font-bold active:scale-98 transition-transform disabled:cursor-not-allowed",children:t.isPending?"ƒêang th√™m...":"Th√™m NCC"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"T√¨m theo t√™n, SƒêT...",value:c,onChange:o=>m(o.target.value),className:"w-full px-4 py-3 pl-10 border border-slate-300 dark:border-slate-600 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:a.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"üë§"}),e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y nh√† cung c·∫•p"})]}):a.map(o=>e.jsxs("div",{onClick:()=>{i(o.id),f()},className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${b===o.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 active:scale-98"}`,children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:o.name}),o.phone&&e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["üìû ",o.phone]}),o.address&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["üìç ",o.address]})]},o.id))}),e.jsx("div",{className:"p-3 border-t border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsxs("button",{onClick:()=>h(!0),className:"w-full py-4 bg-green-600 hover:bg-green-700 active:scale-98 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform",children:[e.jsx("span",{className:"text-xl",children:"+"}),e.jsx("span",{children:"Th√™m nh√† cung c·∫•p m·ªõi"})]})})]})]})}):null},Os=({isOpen:d,onClose:f,parts:b,receiptItems:i,setReceiptItems:c,selectedSupplier:m,setSelectedSupplier:x,searchTerm:h,setSearchTerm:l,onSave:t,discount:r,setDiscount:s,discountType:a,setDiscountType:n,paymentMethod:o,setPaymentMethod:u,paymentType:g,setPaymentType:k,partialAmount:v,setPartialAmount:E,showAddProductModal:O,setShowAddProductModal:B,onAddNewProduct:w,currentBranchId:C})=>{var Me,ie,Fe;const[_,S]=y.useState(1),[M,L]=y.useState(!1),[P,D]=y.useState(""),$=y.useRef(null),[z,H]=y.useState(!1),[te,ce]=y.useState(!1),{data:de=[]}=yr();console.log("üîç GoodsReceiptMobileModal - parts:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üîç searchTerm:",h);const Y=(b==null?void 0:b.filter(R=>{var J,se;if(!h||h.trim()==="")return!0;const re=h.toLowerCase().trim();return((J=R.name)==null?void 0:J.toLowerCase().includes(re))||((se=R.sku)==null?void 0:se.toLowerCase().includes(re))}))||[];console.log("üîç filteredParts:",(Y==null?void 0:Y.length)||0);const ee=R=>{i.find(J=>J.partId===R.id)?(c(J=>J.map(se=>se.partId===R.id?{...se,quantity:se.quantity+1}:se)),q.success(`ƒê√£ tƒÉng s·ªë l∆∞·ª£ng ${R.name}`)):(c(J=>{var se,be,N;return[...J,{partId:R.id,partName:R.name,sku:R.sku,quantity:1,importPrice:((se=R.costPrice)==null?void 0:se[C])||0,sellingPrice:((be=R.retailPrice)==null?void 0:be[C])||0,wholesalePrice:((N=R.wholesalePrice)==null?void 0:N[C])||0}]}),q.success(`ƒê√£ th√™m ${R.name} v√†o phi·∫øu nh·∫≠p`)),l(""),setTimeout(()=>{var J;return(J=$.current)==null?void 0:J.focus()},100)},U=R=>{if(R.preventDefault(),!P.trim())return;const re=P.trim(),J=b.find(se=>{var be,N;return((be=se.sku)==null?void 0:be.toLowerCase())===re.toLowerCase()||((N=se.name)==null?void 0:N.toLowerCase().includes(re.toLowerCase()))});J?(ee(J),D("")):(q.info(`S·∫£n ph·∫©m m√£ ${re} ch∆∞a c√≥. Vui l√≤ng th√™m th√¥ng tin s·∫£n ph·∫©m m·ªõi.`,{autoClose:3e3}),setTimeout(()=>{B(!0)},500))},ue=R=>{console.log("üì∑ Camera scanned:",R);const re=be=>be.toLowerCase().replace(/[-\s./\\]/g,""),J=re(R),se=b.find(be=>{var N,G;return re(be.barcode||"")===J||((N=be.barcode)==null?void 0:N.toLowerCase())===R.toLowerCase()||re(be.sku||"")===J||((G=be.sku)==null?void 0:G.toLowerCase())===R.toLowerCase()});se?(i.find(N=>N.partId===se.id)?c(N=>N.map(G=>G.partId===se.id?{...G,quantity:G.quantity+1}:G)):(c(N=>{var G,Z,K;return[...N,{partId:se.id,partName:se.name,sku:se.sku,quantity:1,importPrice:((G=se.costPrice)==null?void 0:G[C])||0,sellingPrice:((Z=se.retailPrice)==null?void 0:Z[C])||0,wholesalePrice:((K=se.wholesalePrice)==null?void 0:K[C])||0}]}),q.success(`ƒê√£ th√™m ${se.name}`)),l("")):(q.info(`S·∫£n ph·∫©m m√£ ${R} ch∆∞a c√≥.`),D(R),setTimeout(()=>{B(!0)},500))};y.useEffect(()=>{te&&setTimeout(()=>{var R;return(R=$.current)==null?void 0:R.focus()},100)},[te]);const T=R=>{c(re=>re.filter((J,se)=>se!==R))},p=i.reduce((R,re)=>R+re.quantity*re.importPrice,0),A=a==="percent"?Math.round(p*r/100):r,Q=Math.max(0,p-A),oe=()=>{if(!m){alert("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}S(2)},Ce=()=>{alert("Ch·ª©c nƒÉng l∆∞u nh√°p ƒëang ph√°t tri·ªÉn")};return d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-end justify-center sm:hidden",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 w-full h-[95vh] rounded-t-3xl overflow-hidden flex flex-col",children:_===1?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:f,className:"text-white text-2xl leading-none",children:"√ó"}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"T·∫°o phi·∫øu nh·∫≠p kho"})]})}),e.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsx("div",{onClick:()=>L(!0),className:`p-4 rounded-xl border-2 cursor-pointer active:scale-98 transition-transform ${m?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-dashed border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"NH√Ä CUNG C·∫§P"}),e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:((Me=de.find(R=>R.id===m))==null?void 0:Me.name)||""}),((ie=de.find(R=>R.id===m))==null?void 0:ie.phone)&&e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:(Fe=de.find(R=>R.id===m))==null?void 0:Fe.phone})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üë§"}),e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Ch·ªçn nh√† cung c·∫•p"})]})}),e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-10 flex-shrink-0 space-y-2",children:[te&&e.jsxs("form",{onSubmit:U,className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),e.jsx("input",{ref:$,type:"text",placeholder:"Nh·∫≠p SKU ho·∫∑c qu√©t...",value:P,onChange:R=>D(R.target.value),className:"w-full px-4 py-3 pl-11 border-2 border-blue-400 dark:border-blue-600 rounded-xl bg-blue-50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 text-base font-mono placeholder:text-blue-500/70"}),P&&e.jsx("button",{type:"button",onClick:()=>D(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("button",{type:"button",onClick:()=>{ce(!1),D("")},className:"w-12 h-[50px] flex items-center justify-center border-2 border-slate-300 dark:border-slate-600 rounded-xl text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Ho·∫∑c t√¨m ki·∫øm th·ªß c√¥ng...",value:h,onChange:R=>l(R.target.value),className:"w-full px-4 py-3 pl-10 border border-slate-300 dark:border-slate-600 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),!te&&e.jsx("button",{type:"button",onClick:()=>{ce(!0)},className:"w-12 h-[50px] flex items-center justify-center border-2 border-blue-400 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl transition-all active:scale-95",title:"Qu√©t m√£ v·∫°ch",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("button",{type:"button",onClick:()=>H(!0),className:"w-12 h-[50px] flex items-center justify-center bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl shadow-lg transition-all active:scale-95",children:e.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 bg-slate-50 dark:bg-slate-900",children:[!b||b.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"‚è≥"}),e.jsx("div",{children:"ƒêang t·∫£i danh s√°ch s·∫£n ph·∫©m..."})]}):Y.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"üì¶"}),e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),h&&e.jsxs("div",{className:"text-sm mt-2",children:['T√¨m ki·∫øm: "',h,'"']})]}):e.jsx("div",{className:"space-y-2",children:Y.map(R=>{var J,se;const re=i.find(be=>be.partId===R.id);return e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100 text-base leading-tight mb-1",children:R.name}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:R.sku}),R.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0 rounded-full text-[9px] font-medium ${je(R.category).bg} ${je(R.category).text}`,children:R.category})]}),e.jsxs("div",{className:"mt-2 flex gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Nh·∫≠p:"," "]}),e.jsx("span",{className:"font-medium text-orange-600 dark:text-orange-400",children:W(((J=R.costPrice)==null?void 0:J[C])||0)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["B√°n:"," "]}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:W(((se=R.retailPrice)==null?void 0:se[C])||0)})]})]}),re&&e.jsx("div",{className:"mt-2 text-sm",children:e.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:["ƒê√£ th√™m: ",re.quantity," √ó"," ",W(re.importPrice)]})})]}),e.jsx("button",{onClick:()=>ee(R),className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-2xl leading-none active:scale-95 transition-transform",children:"+"})]})},R.id)})}),e.jsxs("button",{onClick:()=>B(!0),className:"w-full mt-3 py-4 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl text-slate-500 dark:text-slate-400 hover:border-blue-400 hover:text-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"+"}),e.jsx("span",{className:"font-medium",children:"T·∫°o s·∫£n ph·∫©m m·ªõi"})]})]}),i.length>0&&e.jsx("div",{className:"flex-shrink-0 bg-gradient-to-t from-white via-white dark:from-slate-800 dark:via-slate-800 to-transparent pt-6 pb-safe pb-4 px-3",children:e.jsxs("button",{onClick:oe,className:"w-full bg-blue-600 hover:bg-blue-700 active:scale-98 text-white py-4 rounded-xl font-bold text-lg flex items-center justify-between px-6 shadow-lg transition-transform",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-white/20 rounded-full w-8 h-8 flex items-center justify-center font-bold",children:i.reduce((R,re)=>R+re.quantity,0)}),e.jsx("span",{children:"Ti·∫øp t·ª•c"})]}),e.jsx("span",{className:"font-bold",children:W(p)})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>S(1),className:"text-white text-xl leading-none",children:"‚Üê"}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"X√°c nh·∫≠n nh·∫≠p kho"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900",children:[e.jsx("div",{className:"p-3 space-y-2",children:i.map((R,re)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100 leading-tight",children:R.partName}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["SKU: ",R.sku]})]}),e.jsx("button",{onClick:()=>T(re),className:"text-red-500 hover:text-red-600 text-xl",children:"√ó"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{if(R.quantity>1){const J=[...i];J[re].quantity-=1,c(J)}},className:"w-8 h-8 rounded-lg border-2 border-slate-300 dark:border-slate-600 flex items-center justify-center text-slate-600 dark:text-slate-400 font-bold active:scale-95 transition-transform",children:"‚àí"}),e.jsx("div",{className:"w-12 text-center font-bold text-lg text-slate-900 dark:text-slate-100",children:R.quantity}),e.jsx("button",{onClick:()=>{const J=[...i];J[re].quantity+=1,c(J)},className:"w-8 h-8 rounded-lg border-2 border-blue-500 flex items-center justify-center text-blue-600 font-bold active:scale-95 transition-transform",children:"+"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[W(R.importPrice)," / c√°i"]}),e.jsx("div",{className:"font-bold text-orange-600 dark:text-orange-400",children:W(R.quantity*R.importPrice)})]})]})]},re))}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-slate-700 dark:text-slate-300",children:[e.jsx("span",{children:"T·ªïng ti·ªÅn h√†ng"}),e.jsx("span",{className:"font-medium",children:W(p)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Gi·∫£m gi√°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",inputMode:"numeric",value:r,onChange:R=>s(Number(R.target.value)),placeholder:"0",className:"w-24 px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg text-right bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("select",{value:a,onChange:R=>n(R.target.value),className:"px-2 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm",children:[e.jsx("option",{value:"amount",children:"‚Ç´"}),e.jsx("option",{value:"percent",children:"%"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t-2 border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"C·∫¶N THANH TO√ÅN"}),e.jsx("span",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:W(Q)})]})]})}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u("cash"),className:`flex-1 py-3 rounded-xl font-medium transition-all ${o==="cash"?"bg-green-600 text-white shadow-lg":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600"}`,children:"üíµ Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>u("bank"),className:`flex-1 py-3 rounded-xl font-medium transition-all ${o==="bank"?"bg-blue-600 text-white shadow-lg":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600"}`,children:"üè¶ Chuy·ªÉn kho·∫£n"})]})]}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-slate-200 dark:bg-slate-700 rounded-xl p-1 flex gap-1",children:[e.jsx("button",{onClick:()=>{k("full"),E(0)},className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="full"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>k("partial"),className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="partial"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"1 Ph·∫ßn"}),e.jsx("button",{onClick:()=>{k("note"),E(0)},className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="note"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"N·ª£"})]})}),g==="partial"&&e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-300 dark:border-slate-600",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ti·ªÅn tr·∫£ NCC"}),e.jsx("input",{type:"number",inputMode:"numeric",value:v,onChange:R=>{const re=Number(R.target.value);re<=Q?E(re):alert("S·ªë ti·ªÅn tr·∫£ kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t qu√° t·ªïng ti·ªÅn")},placeholder:"Nh·∫≠p s·ªë ti·ªÅn",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-lg text-right text-lg font-bold bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsxs("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",W(Q-v)]})]})}),g==="note"&&e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm text-red-700 dark:text-red-400 mb-1",children:"S·ªë ti·ªÅn n·ª£"}),e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:W(Q)})]})})]}),e.jsx("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 space-y-2 flex-shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ce,className:"flex-1 py-3 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-xl font-medium active:scale-98 transition-transform",children:"üíæ L∆∞u Nh√°p"}),e.jsx("button",{onClick:t,disabled:!m||i.length===0,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 dark:disabled:bg-slate-600 text-white rounded-xl font-bold active:scale-98 transition-transform disabled:cursor-not-allowed",children:"‚úÖ NH·∫¨P KHO"})]})})]})})}),e.jsx(Ps,{isOpen:M,onClose:()=>L(!1),selectedSupplierId:m,onSelectSupplier:x}),e.jsx(Ra,{isOpen:z,onClose:()=>H(!1),onScan:ue,title:"Qu√©t m√£ v·∫°ch s·∫£n ph·∫©m"})]}):null},Ms=({transactions:d})=>{const{currentBranchId:f}=ar(),{data:b=[]}=Da(),[i,c]=y.useState("7days"),[m,x]=y.useState(tt(new Date,!0)),[h,l]=y.useState(tt(new Date,!0)),[t,r]=y.useState(""),[s,a]=y.useState(!1),[n,o]=y.useState(null),u=y.useMemo(()=>{let v=d.filter(O=>O.type==="Nh·∫≠p kho");const E=new Date;switch(i){case"7days":const O=new Date(E.getTime()-6048e5);v=v.filter(C=>new Date(C.date)>=O);break;case"30days":const B=new Date(E.getTime()-720*60*60*1e3);v=v.filter(C=>new Date(C.date)>=B);break;case"thisMonth":const w=new Date(E.getFullYear(),E.getMonth(),1);v=v.filter(C=>new Date(C.date)>=w);break;case"custom":v=v.filter(C=>{const _=new Date(C.date);return _>=new Date(m)&&_<=new Date(h)});break}if(t){const O=t.toLowerCase();v=v.filter(B=>B.partName.toLowerCase().includes(O)||B.notes&&B.notes.toLowerCase().includes(O))}return v.sort((O,B)=>new Date(B.date).getTime()-new Date(O.date).getTime())},[d,i,m,h,t]),g=y.useMemo(()=>u.reduce((v,E)=>v+E.totalPrice,0),[u]),k=y.useMemo(()=>{const v=new Map;return u.forEach(E=>{var _,S;const O=new Date(E.date),B=`${O.getFullYear()}-${String(O.getMonth()+1).padStart(2,"0")}-${String(O.getDate()).padStart(2,"0")}`,w=(_=E.notes)!=null&&_.includes("NCC:")?(S=E.notes.split("NCC:")[1])==null?void 0:S.trim():"Kh√¥ng x√°c ƒë·ªãnh",C=`${B}_${w}_${O.getHours()}_${O.getMinutes()}`;v.has(C)||v.set(C,[]),v.get(C).push(E)}),Array.from(v.entries()).map(([E,O],B)=>{var S,M,L;const w=O[0],C=new Date(w.date);let _="";if(w.notes){const P=w.notes.match(/NH-\d{8}-\d{3}/);P&&(_=P[0])}return _||(_=`NH-${`${C.getFullYear()}${String(C.getMonth()+1).padStart(2,"0")}${String(C.getDate()).padStart(2,"0")}`}-${String(v.size-B).padStart(3,"0")}`),{receiptCode:_,date:w.date,supplier:(S=w.notes)!=null&&S.includes("NCC:")?(L=(M=w.notes.split("NCC:")[1])==null?void 0:M.split("|")[0])==null?void 0:L.trim():"Kh√¥ng x√°c ƒë·ªãnh",items:O,total:O.reduce((P,D)=>P+D.totalPrice,0)}}).sort((E,O)=>new Date(O.date).getTime()-new Date(E.date).getTime())},[u]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-[#0f172a]",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white dark:bg-[#1e293b] border-b border-slate-200 dark:border-slate-700 p-3 space-y-2",children:[e.jsx("input",{type:"text",value:t,onChange:v=>r(v.target.value),placeholder:"T√¨m NCC, ph·ª• t√πng...",className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 placeholder-slate-400 text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>a(!0),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"B·ªô l·ªçc"]}),e.jsx("div",{className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:k.length})]})]}),e.jsx("div",{className:"px-3 py-3 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-800",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"T·ªïng gi√° tr·ªã nh·∫≠p"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:W(g)})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì¶"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Kh√¥ng c√≥ d·ªØ li·ªáu"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c th·ªùi gian"})]}):e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:k.map(v=>{const E=new Date(v.date),O=E.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),B=E.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),w=b.find(S=>{var M;return(M=S.description)==null?void 0:M.includes(v.receiptCode)}),C=(w==null?void 0:w.remainingAmount)||0,_=C>0;return e.jsxs("button",{onClick:()=>o({...v,date:new Date(v.date)}),className:"w-full p-4 bg-white dark:bg-[#1e293b] hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-cyan-600 dark:text-cyan-400",children:v.receiptCode}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:[O," ¬∑ ",B]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-white",children:W(v.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-lg",children:"üè¢"}),e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:v.supplier})]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:[v.items.length," s·∫£n ph·∫©m"]}),_&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",W(C)]})})]},v.receiptCode)})})})]}),s&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"B·ªô l·ªçc th·ªùi gian"}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Th·ªùi gian"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{key:"7days",label:"7 ng√†y qua"},{key:"30days",label:"30 ng√†y qua"},{key:"thisMonth",label:"Th√°ng n√†y"},{key:"custom",label:"T√πy ch·ªçn"}].map(v=>e.jsx("button",{onClick:()=>c(v.key),className:`px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${i===v.key?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:v.label},v.key))})]}),i==="custom"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ª´ ng√†y"}),e.jsx("input",{type:"date",value:m,onChange:v=>x(v.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·∫øn ng√†y"}),e.jsx("input",{type:"date",value:h,onChange:v=>l(v.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700",children:e.jsx("button",{onClick:()=>a(!1),className:"w-full px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium",children:"√Åp d·ª•ng"})})]})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>o(null)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt phi·∫øu nh·∫≠p"}),e.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{className:"bg-cyan-50 dark:bg-cyan-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-cyan-600 dark:text-cyan-400 mb-1",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"text-lg font-bold text-cyan-600 dark:text-cyan-400",children:n.receiptCode})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Ng√†y nh·∫≠p"}),e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:tt(new Date(n.date))})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:W(n.total)})]})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400 mb-1",children:"Nh√† cung c·∫•p"}),e.jsx("div",{className:"text-base font-semibold text-orange-900 dark:text-orange-100",children:n.supplier})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 mb-2",children:["Danh s√°ch s·∫£n ph·∫©m (",n.items.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.items.map(v=>e.jsxs("div",{className:"flex items-start justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:[v.quantity," x ",v.partName]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:[W(v.unitPrice||0)," / SP"]})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:W(v.quantity*(v.unitPrice||0))})]},v.id))})]})]})]})]})]})};var pt={},st={},vt={},Tr;function Se(){if(Tr)return vt;Tr=1,Object.defineProperty(vt,"__esModule",{value:!0});function d(b,i){if(!(b instanceof i))throw new TypeError("Cannot call a class as a function")}var f=function b(i,c){d(this,b),this.data=i,this.text=c.text||i,this.options=c};return vt.default=f,vt}var Lr;function Ts(){if(Lr)return st;Lr=1,Object.defineProperty(st,"__esModule",{value:!0}),st.CODE39=void 0;var d=(function(){function u(g,k){for(var v=0;v<k.length;v++){var E=k[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(g,E.key,E)}}return function(g,k,v){return k&&u(g.prototype,k),v&&u(g,v),g}})(),f=Se(),b=i(f);function i(u){return u&&u.__esModule?u:{default:u}}function c(u,g){if(!(u instanceof g))throw new TypeError("Cannot call a class as a function")}function m(u,g){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:u}function x(u,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);u.prototype=Object.create(g&&g.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(u,g):u.__proto__=g)}var h=(function(u){x(g,u);function g(k,v){return c(this,g),k=k.toUpperCase(),v.mod43&&(k+=a(o(k))),m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,k,v))}return d(g,[{key:"encode",value:function(){for(var v=r("*"),E=0;E<this.data.length;E++)v+=r(this.data[E])+"0";return v+=r("*"),{data:v,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),g})(b.default),l=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],t=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function r(u){return s(n(u))}function s(u){return t[u].toString(2)}function a(u){return l[u]}function n(u){return l.indexOf(u)}function o(u){for(var g=0,k=0;k<u.length;k++)g+=n(u[k]);return g=g%43,g}return st.CODE39=h,st}var Oe={},kt={},yt={},fe={},Ar;function mt(){if(Ar)return fe;Ar=1,Object.defineProperty(fe,"__esModule",{value:!0});var d;function f(l,t,r){return t in l?Object.defineProperty(l,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):l[t]=r,l}var b=fe.SET_A=0,i=fe.SET_B=1,c=fe.SET_C=2;fe.SHIFT=98;var m=fe.START_A=103,x=fe.START_B=104,h=fe.START_C=105;return fe.MODULO=103,fe.STOP=106,fe.FNC1=207,fe.SET_BY_CODE=(d={},f(d,m,b),f(d,x,i),f(d,h,c),d),fe.SWAP={101:b,100:i,99:c},fe.A_START_CHAR="√ê",fe.B_START_CHAR="√ë",fe.C_START_CHAR="√í",fe.A_CHARS="[\0-_√à-√è]",fe.B_CHARS="[ -√à-√è]",fe.C_CHARS="(√è*[0-9]{2}√è*)",fe.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],fe}var Rr;function sr(){if(Rr)return yt;Rr=1,Object.defineProperty(yt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=Se(),b=c(f),i=mt();function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){m(this,r);var n=x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s.substring(1),a));return n.bytes=s.split("").map(function(o){return o.charCodeAt(0)}),n}return d(r,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var a=this.bytes,n=a.shift()-105,o=i.SET_BY_CODE[n];if(o===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&a.unshift(i.FNC1);var u=r.next(a,1,o);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:r.getBar(n)+u.result+r.getBar((u.checksum+n)%i.MODULO)+r.getBar(i.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var a=this.options.ean128||!1;return typeof a=="string"&&(a=a.toLowerCase()==="true"),a}}],[{key:"getBar",value:function(a){return i.BARS[a]?i.BARS[a].toString():""}},{key:"correctIndex",value:function(a,n){if(n===i.SET_A){var o=a.shift();return o<32?o+64:o-32}else return n===i.SET_B?a.shift()-32:(a.shift()-48)*10+a.shift()-48}},{key:"next",value:function(a,n,o){if(!a.length)return{result:"",checksum:0};var u=void 0,g=void 0;if(a[0]>=200){g=a.shift()-105;var k=i.SWAP[g];k!==void 0?u=r.next(a,n+1,k):((o===i.SET_A||o===i.SET_B)&&g===i.SHIFT&&(a[0]=o===i.SET_A?a[0]>95?a[0]-96:a[0]:a[0]<32?a[0]+96:a[0]),u=r.next(a,n+1,o))}else g=r.correctIndex(a,o),u=r.next(a,n+1,o);var v=r.getBar(g),E=g*n;return{result:v+u.result,checksum:E+u.checksum}}}]),r})(b.default);return yt.default=l,yt}var jt={},$r;function Ls(){if($r)return jt;$r=1,Object.defineProperty(jt,"__esModule",{value:!0});var d=mt(),f=function(h){return h.match(new RegExp("^"+d.A_CHARS+"*"))[0].length},b=function(h){return h.match(new RegExp("^"+d.B_CHARS+"*"))[0].length},i=function(h){return h.match(new RegExp("^"+d.C_CHARS+"*"))[0]};function c(x,h){var l=h?d.A_CHARS:d.B_CHARS,t=x.match(new RegExp("^("+l+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(t)return t[1]+"√å"+m(x.substring(t[1].length));var r=x.match(new RegExp("^"+l+"+"))[0];return r.length===x.length?x:r+String.fromCharCode(h?205:206)+c(x.substring(r.length),!h)}function m(x){var h=i(x),l=h.length;if(l===x.length)return x;x=x.substring(l);var t=f(x)>=b(x);return h+String.fromCharCode(t?206:205)+c(x,t)}return jt.default=function(x){var h=void 0,l=i(x).length;if(l>=2)h=d.C_START_CHAR+m(x);else{var t=f(x)>b(x);h=(t?d.A_START_CHAR:d.B_START_CHAR)+c(x,t)}return h.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(r,s){return"√ã"+s})},jt}var Ir;function As(){if(Ir)return kt;Ir=1,Object.defineProperty(kt,"__esModule",{value:!0});var d=sr(),f=c(d),b=Ls(),i=c(b);function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){if(m(this,r),/^[\x00-\x7F\xC8-\xD3]+$/.test(s))var n=x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,(0,i.default)(s),a));else var n=x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a));return x(n)}return r})(f.default);return kt.default=l,kt}var wt={},Dr;function Rs(){if(Dr)return wt;Dr=1,Object.defineProperty(wt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=sr(),b=c(f),i=mt();function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return m(this,r),x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.A_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.A_CHARS+"+$").test(this.data)}}]),r})(b.default);return wt.default=l,wt}var Nt={},qr;function $s(){if(qr)return Nt;qr=1,Object.defineProperty(Nt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=sr(),b=c(f),i=mt();function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return m(this,r),x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.B_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.B_CHARS+"+$").test(this.data)}}]),r})(b.default);return Nt.default=l,Nt}var _t={},Br;function Is(){if(Br)return _t;Br=1,Object.defineProperty(_t,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=sr(),b=c(f),i=mt();function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return m(this,r),x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.C_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.C_CHARS+"+$").test(this.data)}}]),r})(b.default);return _t.default=l,_t}var zr;function Ds(){if(zr)return Oe;zr=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.CODE128C=Oe.CODE128B=Oe.CODE128A=Oe.CODE128=void 0;var d=As(),f=l(d),b=Rs(),i=l(b),c=$s(),m=l(c),x=Is(),h=l(x);function l(t){return t&&t.__esModule?t:{default:t}}return Oe.CODE128=f.default,Oe.CODE128A=i.default,Oe.CODE128B=m.default,Oe.CODE128C=h.default,Oe}var ke={},St={},De={},Fr;function ft(){return Fr||(Fr=1,Object.defineProperty(De,"__esModule",{value:!0}),De.SIDE_BIN="101",De.MIDDLE_BIN="01010",De.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},De.EAN2_STRUCTURE=["LL","LG","GL","GG"],De.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],De.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]),De}var Ct={},Et={},Hr;function bt(){if(Hr)return Et;Hr=1,Object.defineProperty(Et,"__esModule",{value:!0});var d=ft(),f=function(i,c,m){var x=i.split("").map(function(l,t){return d.BINARIES[c[t]]}).map(function(l,t){return l?l[i[t]]:""});if(m){var h=i.length-1;x=x.map(function(l,t){return t<h?l+m:l})}return x.join("")};return Et.default=f,Et}var Gr;function Ba(){if(Gr)return Ct;Gr=1,Object.defineProperty(Ct,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),f=ft(),b=bt(),i=x(b),c=Se(),m=x(c);function x(s){return s&&s.__esModule?s:{default:s}}function h(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function l(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function t(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var r=(function(s){t(a,s);function a(n,o){h(this,a);var u=l(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.fontSize=!o.flat&&o.fontSize>o.width*10?o.width*10:o.fontSize,u.guardHeight=o.height+u.fontSize/2+o.textMargin,u}return d(a,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(o,u){return this.text.substr(o,u)}},{key:"leftEncode",value:function(o,u){return(0,i.default)(o,u)}},{key:"rightText",value:function(o,u){return this.text.substr(o,u)}},{key:"rightEncode",value:function(o,u){return(0,i.default)(o,u)}},{key:"encodeGuarded",value:function(){var o={fontSize:this.fontSize},u={height:this.guardHeight};return[{data:f.SIDE_BIN,options:u},{data:this.leftEncode(),text:this.leftText(),options:o},{data:f.MIDDLE_BIN,options:u},{data:this.rightEncode(),text:this.rightText(),options:o},{data:f.SIDE_BIN,options:u}]}},{key:"encodeFlat",value:function(){var o=[f.SIDE_BIN,this.leftEncode(),f.MIDDLE_BIN,this.rightEncode(),f.SIDE_BIN];return{data:o.join(""),text:this.text}}}]),a})(m.default);return Ct.default=r,Ct}var Vr;function qs(){if(Vr)return St;Vr=1,Object.defineProperty(St,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),f=function s(a,n,o){a===null&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,n);if(u===void 0){var g=Object.getPrototypeOf(a);return g===null?void 0:s(g,n,o)}else{if("value"in u)return u.value;var k=u.get;return k===void 0?void 0:k.call(o)}},b=ft(),i=Ba(),c=m(i);function m(s){return s&&s.__esModule?s:{default:s}}function x(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function h(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function l(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var t=function(a){var n=a.substr(0,12).split("").map(function(o){return+o}).reduce(function(o,u,g){return g%2?o+u*3:o+u},0);return(10-n%10)%10},r=(function(s){l(a,s);function a(n,o){x(this,a),n.search(/^[0-9]{12}$/)!==-1&&(n+=t(n));var u=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.lastChar=o.lastChar,u}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===t(this.data)}},{key:"leftText",value:function(){return f(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var o=this.data.substr(1,6),u=b.EAN13_STRUCTURE[this.data[0]];return f(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftEncode",this).call(this,o,u)}},{key:"rightText",value:function(){return f(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var o=this.data.substr(7,6);return f(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightEncode",this).call(this,o,"RRRRRR")}},{key:"encodeGuarded",value:function(){var o=f(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(o.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(o.push({data:"00"}),o.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),o}}]),a})(c.default);return St.default=r,St}var Pt={},Ur;function Bs(){if(Ur)return Pt;Ur=1,Object.defineProperty(Pt,"__esModule",{value:!0});var d=(function(){function r(s,a){for(var n=0;n<a.length;n++){var o=a[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}return function(s,a,n){return a&&r(s.prototype,a),n&&r(s,n),s}})(),f=function r(s,a,n){s===null&&(s=Function.prototype);var o=Object.getOwnPropertyDescriptor(s,a);if(o===void 0){var u=Object.getPrototypeOf(s);return u===null?void 0:r(u,a,n)}else{if("value"in o)return o.value;var g=o.get;return g===void 0?void 0:g.call(n)}},b=Ba(),i=c(b);function c(r){return r&&r.__esModule?r:{default:r}}function m(r,s){if(!(r instanceof s))throw new TypeError("Cannot call a class as a function")}function x(r,s){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s&&(typeof s=="object"||typeof s=="function")?s:r}function h(r,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof s);r.prototype=Object.create(s&&s.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(r,s):r.__proto__=s)}var l=function(s){var a=s.substr(0,7).split("").map(function(n){return+n}).reduce(function(n,o,u){return u%2?n+o:n+o*3},0);return(10-a%10)%10},t=(function(r){h(s,r);function s(a,n){return m(this,s),a.search(/^[0-9]{7}$/)!==-1&&(a+=l(a)),x(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,a,n))}return d(s,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===l(this.data)}},{key:"leftText",value:function(){return f(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var n=this.data.substr(0,4);return f(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"leftEncode",this).call(this,n,"LLLL")}},{key:"rightText",value:function(){return f(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var n=this.data.substr(4,4);return f(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"rightEncode",this).call(this,n,"RRRR")}}]),s})(i.default);return Pt.default=t,Pt}var Ot={},Kr;function zs(){if(Kr)return Ot;Kr=1,Object.defineProperty(Ot,"__esModule",{value:!0});var d=(function(){function a(n,o){for(var u=0;u<o.length;u++){var g=o[u];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(n,g.key,g)}}return function(n,o,u){return o&&a(n.prototype,o),u&&a(n,u),n}})(),f=ft(),b=bt(),i=x(b),c=Se(),m=x(c);function x(a){return a&&a.__esModule?a:{default:a}}function h(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function l(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function t(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):a.__proto__=n)}var r=function(n){var o=n.split("").map(function(u){return+u}).reduce(function(u,g,k){return k%2?u+g*9:u+g*3},0);return o%10},s=(function(a){t(n,a);function n(o,u){return h(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,o,u))}return d(n,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var u=f.EAN5_STRUCTURE[r(this.data)];return{data:"1011"+(0,i.default)(this.data,u,"01"),text:this.text}}}]),n})(m.default);return Ot.default=s,Ot}var Mt={},Xr;function Fs(){if(Xr)return Mt;Xr=1,Object.defineProperty(Mt,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),f=ft(),b=bt(),i=x(b),c=Se(),m=x(c);function x(s){return s&&s.__esModule?s:{default:s}}function h(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function l(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function t(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var r=(function(s){t(a,s);function a(n,o){return h(this,a),l(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o))}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var o=f.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,i.default)(this.data,o,"01"),text:this.text}}}]),a})(m.default);return Mt.default=r,Mt}var nt={},Wr;function za(){if(Wr)return nt;Wr=1,Object.defineProperty(nt,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})();nt.checksum=r;var f=bt(),b=m(f),i=Se(),c=m(i);function m(s){return s&&s.__esModule?s:{default:s}}function x(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function h(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function l(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var t=(function(s){l(a,s);function a(n,o){x(this,a),n.search(/^[0-9]{11}$/)!==-1&&(n+=r(n));var u=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.displayValue=o.displayValue,o.fontSize>o.width*10?u.fontSize=o.width*10:u.fontSize=o.fontSize,u.guardHeight=o.height+u.fontSize/2+o.textMargin,u}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==r(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var o="";return o+="101",o+=(0,b.default)(this.data.substr(0,6),"LLLLLL"),o+="01010",o+=(0,b.default)(this.data.substr(6,6),"RRRRRR"),o+="101",{data:o,text:this.text}}},{key:"guardedEncoding",value:function(){var o=[];return this.displayValue&&o.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),o.push({data:"101"+(0,b.default)(this.data[0],"L"),options:{height:this.guardHeight}}),o.push({data:(0,b.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),o.push({data:"01010",options:{height:this.guardHeight}}),o.push({data:(0,b.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),o.push({data:(0,b.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&o.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),o}}]),a})(c.default);function r(s){var a=0,n;for(n=1;n<11;n+=2)a+=parseInt(s[n]);for(n=0;n<11;n+=2)a+=parseInt(s[n])*3;return(10-a%10)%10}return nt.default=t,nt}var Tt={},Qr;function Hs(){if(Qr)return Tt;Qr=1,Object.defineProperty(Tt,"__esModule",{value:!0});var d=(function(){function o(u,g){for(var k=0;k<g.length;k++){var v=g[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}return function(u,g,k){return g&&o(u.prototype,g),k&&o(u,k),u}})(),f=bt(),b=x(f),i=Se(),c=x(i),m=za();function x(o){return o&&o.__esModule?o:{default:o}}function h(o,u){if(!(o instanceof u))throw new TypeError("Cannot call a class as a function")}function l(o,u){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:o}function t(o,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);o.prototype=Object.create(u&&u.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(o,u):o.__proto__=u)}var r=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],s=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],a=(function(o){t(u,o);function u(g,k){h(this,u);var v=l(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,g,k));if(v.isValid=!1,g.search(/^[0-9]{6}$/)!==-1)v.middleDigits=g,v.upcA=n(g,"0"),v.text=k.text||""+v.upcA[0]+g+v.upcA[v.upcA.length-1],v.isValid=!0;else if(g.search(/^[01][0-9]{7}$/)!==-1)if(v.middleDigits=g.substring(1,g.length-1),v.upcA=n(v.middleDigits,g[0]),v.upcA[v.upcA.length-1]===g[g.length-1])v.isValid=!0;else return l(v);else return l(v);return v.displayValue=k.displayValue,k.fontSize>k.width*10?v.fontSize=k.width*10:v.fontSize=k.fontSize,v.guardHeight=k.height+v.fontSize/2+k.textMargin,v}return d(u,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var k="";return k+="101",k+=this.encodeMiddleDigits(),k+="010101",{data:k,text:this.text}}},{key:"guardedEncoding",value:function(){var k=[];return this.displayValue&&k.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),k.push({data:"101",options:{height:this.guardHeight}}),k.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),k.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&k.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),k}},{key:"encodeMiddleDigits",value:function(){var k=this.upcA[0],v=this.upcA[this.upcA.length-1],E=s[parseInt(v)][parseInt(k)];return(0,b.default)(this.middleDigits,E)}}]),u})(c.default);function n(o,u){for(var g=parseInt(o[o.length-1]),k=r[g],v="",E=0,O=0;O<k.length;O++){var B=k[O];B==="X"?v+=o[E++]:v+=B}return v=""+u+v,""+v+(0,m.checksum)(v)}return Tt.default=a,Tt}var Yr;function Gs(){if(Yr)return ke;Yr=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.UPCE=ke.UPC=ke.EAN2=ke.EAN5=ke.EAN8=ke.EAN13=void 0;var d=qs(),f=a(d),b=Bs(),i=a(b),c=zs(),m=a(c),x=Fs(),h=a(x),l=za(),t=a(l),r=Hs(),s=a(r);function a(n){return n&&n.__esModule?n:{default:n}}return ke.EAN13=f.default,ke.EAN8=i.default,ke.EAN5=m.default,ke.EAN2=h.default,ke.UPC=t.default,ke.UPCE=s.default,ke}var Ge={},Lt={},Je={},Jr;function Vs(){return Jr||(Jr=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.START_BIN="1010",Je.END_BIN="11101",Je.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]),Je}var Zr;function Fa(){if(Zr)return Lt;Zr=1,Object.defineProperty(Lt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=Vs(),b=Se(),i=c(b);function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(){return m(this,r),x(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return d(r,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var a=this,n=this.data.match(/.{2}/g).map(function(o){return a.encodePair(o)}).join("");return{data:f.START_BIN+n+f.END_BIN,text:this.text}}},{key:"encodePair",value:function(a){var n=f.BINARIES[a[1]];return f.BINARIES[a[0]].split("").map(function(o,u){return(o==="1"?"111":"1")+(n[u]==="1"?"000":"0")}).join("")}}]),r})(i.default);return Lt.default=l,Lt}var At={},ea;function Us(){if(ea)return At;ea=1,Object.defineProperty(At,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=Fa(),b=i(f);function i(t){return t&&t.__esModule?t:{default:t}}function c(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function m(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function x(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var h=function(r){var s=r.substr(0,13).split("").map(function(a){return parseInt(a,10)}).reduce(function(a,n,o){return a+n*(3-o%2*2)},0);return Math.ceil(s/10)*10-s},l=(function(t){x(r,t);function r(s,a){return c(this,r),s.search(/^[0-9]{13}$/)!==-1&&(s+=h(s)),m(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===h(this.data)}}]),r})(b.default);return At.default=l,At}var ta;function Ks(){if(ta)return Ge;ta=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.ITF14=Ge.ITF=void 0;var d=Fa(),f=c(d),b=Us(),i=c(b);function c(m){return m&&m.__esModule?m:{default:m}}return Ge.ITF=f.default,Ge.ITF14=i.default,Ge}var Ne={},Rt={},ra;function gt(){if(ra)return Rt;ra=1,Object.defineProperty(Rt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=Se(),b=i(f);function i(t){return t&&t.__esModule?t:{default:t}}function c(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function m(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function x(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var h=(function(t){x(r,t);function r(s,a){return c(this,r),m(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"encode",value:function(){for(var a="110",n=0;n<this.data.length;n++){var o=parseInt(this.data[n]),u=o.toString(2);u=l(u,4-u.length);for(var g=0;g<u.length;g++)a+=u[g]=="0"?"100":"110"}return a+="1001",{data:a,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),r})(b.default);function l(t,r){for(var s=0;s<r;s++)t="0"+t;return t}return Rt.default=h,Rt}var $t={},lt={},aa;function nr(){if(aa)return lt;aa=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.mod10=d,lt.mod11=f;function d(b){for(var i=0,c=0;c<b.length;c++){var m=parseInt(b[c]);(c+b.length)%2===0?i+=m:i+=m*2%10+Math.floor(m*2/10)}return(10-i%10)%10}function f(b){for(var i=0,c=[2,3,4,5,6,7],m=0;m<b.length;m++){var x=parseInt(b[b.length-1-m]);i+=c[m%c.length]*x}return(11-i%11)%11}return lt}var sa;function Xs(){if(sa)return $t;sa=1,Object.defineProperty($t,"__esModule",{value:!0});var d=gt(),f=i(d),b=nr();function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r+(0,b.mod10)(r),s))}return t})(f.default);return $t.default=h,$t}var It={},na;function Ws(){if(na)return It;na=1,Object.defineProperty(It,"__esModule",{value:!0});var d=gt(),f=i(d),b=nr();function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r+(0,b.mod11)(r),s))}return t})(f.default);return It.default=h,It}var Dt={},la;function Qs(){if(la)return Dt;la=1,Object.defineProperty(Dt,"__esModule",{value:!0});var d=gt(),f=i(d),b=nr();function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),r+=(0,b.mod10)(r),r+=(0,b.mod10)(r),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return t})(f.default);return Dt.default=h,Dt}var qt={},oa;function Ys(){if(oa)return qt;oa=1,Object.defineProperty(qt,"__esModule",{value:!0});var d=gt(),f=i(d),b=nr();function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),r+=(0,b.mod11)(r),r+=(0,b.mod10)(r),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return t})(f.default);return qt.default=h,qt}var ia;function Js(){if(ia)return Ne;ia=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.MSI1110=Ne.MSI1010=Ne.MSI11=Ne.MSI10=Ne.MSI=void 0;var d=gt(),f=r(d),b=Xs(),i=r(b),c=Ws(),m=r(c),x=Qs(),h=r(x),l=Ys(),t=r(l);function r(s){return s&&s.__esModule?s:{default:s}}return Ne.MSI=f.default,Ne.MSI10=i.default,Ne.MSI11=m.default,Ne.MSI1010=h.default,Ne.MSI1110=t.default,Ne}var ot={},da;function Zs(){if(da)return ot;da=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.pharmacode=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),f=Se(),b=i(f);function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){c(this,t);var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s));return a.number=parseInt(r,10),a}return d(t,[{key:"encode",value:function(){for(var s=this.number,a="";!isNaN(s)&&s!=0;)s%2===0?(a="11100"+a,s=(s-2)/2):(a="100"+a,s=(s-1)/2);return a=a.slice(0,-2),{data:a,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t})(b.default);return ot.pharmacode=h,ot}var it={},ca;function en(){if(ca)return it;ca=1,Object.defineProperty(it,"__esModule",{value:!0}),it.codabar=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),f=Se(),b=i(f);function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){c(this,t),r.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(r="A"+r+"A");var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.toUpperCase(),s));return a.text=a.options.text||a.text.replace(/[A-D]/g,""),a}return d(t,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var s=[],a=this.getEncodings(),n=0;n<this.data.length;n++)s.push(a[this.data.charAt(n)]),n!==this.data.length-1&&s.push("0");return{text:this.text,data:s.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t})(b.default);return it.codabar=h,it}var Ve={},Bt={},Ze={},ua;function tn(){return ua||(ua=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)","√ø"],Ze.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],Ze.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]}),Ze}var ha;function Ha(){if(ha)return Bt;ha=1,Object.defineProperty(Bt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),f=tn(),b=Se(),i=c(b);function c(t){return t&&t.__esModule?t:{default:t}}function m(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return m(this,r),x(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var a=this.data.split("").flatMap(function(g){return f.MULTI_SYMBOLS[g]||g}),n=a.map(function(g){return r.getEncoding(g)}).join(""),o=r.checksum(a,20),u=r.checksum(a.concat(o),15);return{text:this.text,data:r.getEncoding("√ø")+n+r.getEncoding(o)+r.getEncoding(u)+r.getEncoding("√ø")+"1"}}}],[{key:"getEncoding",value:function(a){return f.BINARIES[r.symbolValue(a)]}},{key:"getSymbol",value:function(a){return f.SYMBOLS[a]}},{key:"symbolValue",value:function(a){return f.SYMBOLS.indexOf(a)}},{key:"checksum",value:function(a,n){var o=a.slice().reverse().reduce(function(u,g,k){var v=k%n+1;return u+r.symbolValue(g)*v},0);return r.getSymbol(o%47)}}]),r})(i.default);return Bt.default=l,Bt}var zt={},xa;function rn(){if(xa)return zt;xa=1,Object.defineProperty(zt,"__esModule",{value:!0});var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),f=Ha(),b=i(f);function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return d(t,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),t})(b.default);return zt.default=h,zt}var ma;function an(){if(ma)return Ve;ma=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.CODE93FullASCII=Ve.CODE93=void 0;var d=Ha(),f=c(d),b=rn(),i=c(b);function c(m){return m&&m.__esModule?m:{default:m}}return Ve.CODE93=f.default,Ve.CODE93FullASCII=i.default,Ve}var dt={},fa;function sn(){if(fa)return dt;fa=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.GenericBarcode=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),f=Se(),b=i(f);function i(l){return l&&l.__esModule?l:{default:l}}function c(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function m(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function x(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){x(t,l);function t(r,s){return c(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return d(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t})(b.default);return dt.GenericBarcode=h,dt}var ba;function nn(){if(ba)return pt;ba=1,Object.defineProperty(pt,"__esModule",{value:!0});var d=Ts(),f=Ds(),b=Gs(),i=Ks(),c=Js(),m=Zs(),x=en(),h=an(),l=sn();return pt.default={CODE39:d.CODE39,CODE128:f.CODE128,CODE128A:f.CODE128A,CODE128B:f.CODE128B,CODE128C:f.CODE128C,EAN13:b.EAN13,EAN8:b.EAN8,EAN5:b.EAN5,EAN2:b.EAN2,UPC:b.UPC,UPCE:b.UPCE,ITF14:i.ITF14,ITF:i.ITF,MSI:c.MSI,MSI10:c.MSI10,MSI11:c.MSI11,MSI1010:c.MSI1010,MSI1110:c.MSI1110,pharmacode:m.pharmacode,codabar:x.codabar,CODE93:h.CODE93,CODE93FullASCII:h.CODE93FullASCII,GenericBarcode:l.GenericBarcode},pt}var Ft={},ga;function lr(){if(ga)return Ft;ga=1,Object.defineProperty(Ft,"__esModule",{value:!0});var d=Object.assign||function(f){for(var b=1;b<arguments.length;b++){var i=arguments[b];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(f[c]=i[c])}return f};return Ft.default=function(f,b){return d({},f,b)},Ft}var Ht={},pa;function ln(){if(pa)return Ht;pa=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.default=d;function d(f){var b=[];function i(c){if(Array.isArray(c))for(var m=0;m<c.length;m++)i(c[m]);else c.text=c.text||"",c.data=c.data||"",b.push(c)}return i(f),b}return Ht}var Gt={},va;function on(){if(va)return Gt;va=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.default=d;function d(f){return f.marginTop=f.marginTop||f.margin,f.marginBottom=f.marginBottom||f.margin,f.marginRight=f.marginRight||f.margin,f.marginLeft=f.marginLeft||f.margin,f}return Gt}var Vt={},Ut={},Kt={},ka;function Ga(){if(ka)return Kt;ka=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.default=d;function d(f){var b=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var i in b)b.hasOwnProperty(i)&&(i=b[i],typeof f[i]=="string"&&(f[i]=parseInt(f[i],10)));return typeof f.displayValue=="string"&&(f.displayValue=f.displayValue!="false"),f}return Kt}var Xt={},ya;function Va(){if(ya)return Xt;ya=1,Object.defineProperty(Xt,"__esModule",{value:!0});var d={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};return Xt.default=d,Xt}var ja;function dn(){if(ja)return Ut;ja=1,Object.defineProperty(Ut,"__esModule",{value:!0});var d=Ga(),f=c(d),b=Va(),i=c(b);function c(x){return x&&x.__esModule?x:{default:x}}function m(x){var h={};for(var l in i.default)i.default.hasOwnProperty(l)&&(x.hasAttribute("jsbarcode-"+l.toLowerCase())&&(h[l]=x.getAttribute("jsbarcode-"+l.toLowerCase())),x.hasAttribute("data-"+l.toLowerCase())&&(h[l]=x.getAttribute("data-"+l.toLowerCase())));return h.value=x.getAttribute("jsbarcode-value")||x.getAttribute("data-value"),h=(0,f.default)(h),h}return Ut.default=m,Ut}var Wt={},Qt={},_e={},wa;function Ua(){if(wa)return _e;wa=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.getTotalWidthOfEncodings=_e.calculateEncodingAttributes=_e.getBarcodePadding=_e.getEncodingHeight=_e.getMaximumHeightOfEncodings=void 0;var d=lr(),f=b(d);function b(t){return t&&t.__esModule?t:{default:t}}function i(t,r){return r.height+(r.displayValue&&t.text.length>0?r.fontSize+r.textMargin:0)+r.marginTop+r.marginBottom}function c(t,r,s){if(s.displayValue&&r<t){if(s.textAlign=="center")return Math.floor((t-r)/2);if(s.textAlign=="left")return 0;if(s.textAlign=="right")return Math.floor(t-r)}return 0}function m(t,r,s){for(var a=0;a<t.length;a++){var n=t[a],o=(0,f.default)(r,n.options),u;o.displayValue?u=l(n.text,o,s):u=0;var g=n.data.length*o.width;n.width=Math.ceil(Math.max(u,g)),n.height=i(n,o),n.barcodePadding=c(u,g,o)}}function x(t){for(var r=0,s=0;s<t.length;s++)r+=t[s].width;return r}function h(t){for(var r=0,s=0;s<t.length;s++)t[s].height>r&&(r=t[s].height);return r}function l(t,r,s){var a;if(s)a=s;else if(typeof document<"u")a=document.createElement("canvas").getContext("2d");else return 0;a.font=r.fontOptions+" "+r.fontSize+"px "+r.font;var n=a.measureText(t);if(!n)return 0;var o=n.width;return o}return _e.getMaximumHeightOfEncodings=h,_e.getEncodingHeight=i,_e.getBarcodePadding=c,_e.calculateEncodingAttributes=m,_e.getTotalWidthOfEncodings=x,_e}var Na;function cn(){if(Na)return Qt;Na=1,Object.defineProperty(Qt,"__esModule",{value:!0});var d=(function(){function h(l,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(l,s.key,s)}}return function(l,t,r){return t&&h(l.prototype,t),r&&h(l,r),l}})(),f=lr(),b=c(f),i=Ua();function c(h){return h&&h.__esModule?h:{default:h}}function m(h,l){if(!(h instanceof l))throw new TypeError("Cannot call a class as a function")}var x=(function(){function h(l,t,r){m(this,h),this.canvas=l,this.encodings=t,this.options=r}return d(h,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var r=(0,b.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(r,this.encodings[t]),this.drawCanvasText(r,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,i.calculateEncodingAttributes)(this.encodings,this.options,t);var r=(0,i.getTotalWidthOfEncodings)(this.encodings),s=(0,i.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=r+this.options.marginLeft+this.options.marginRight,this.canvas.height=s,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,r){var s=this.canvas.getContext("2d"),a=r.data,n;t.textPosition=="top"?n=t.marginTop+t.fontSize+t.textMargin:n=t.marginTop,s.fillStyle=t.lineColor;for(var o=0;o<a.length;o++){var u=o*t.width+r.barcodePadding;a[o]==="1"?s.fillRect(u,n,t.width,t.height):a[o]&&s.fillRect(u,n,t.width,t.height*a[o])}}},{key:"drawCanvasText",value:function(t,r){var s=this.canvas.getContext("2d"),a=t.fontOptions+" "+t.fontSize+"px "+t.font;if(t.displayValue){var n,o;t.textPosition=="top"?o=t.marginTop+t.fontSize-t.textMargin:o=t.height+t.textMargin+t.marginTop+t.fontSize,s.font=a,t.textAlign=="left"||r.barcodePadding>0?(n=0,s.textAlign="left"):t.textAlign=="right"?(n=r.width-1,s.textAlign="right"):(n=r.width/2,s.textAlign="center"),s.fillText(r.text,n,o)}}},{key:"moveCanvasDrawing",value:function(t){var r=this.canvas.getContext("2d");r.translate(t.width,0)}},{key:"restoreCanvas",value:function(){var t=this.canvas.getContext("2d");t.restore()}}]),h})();return Qt.default=x,Qt}var Yt={},_a;function un(){if(_a)return Yt;_a=1,Object.defineProperty(Yt,"__esModule",{value:!0});var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),f=lr(),b=c(f),i=Ua();function c(l){return l&&l.__esModule?l:{default:l}}function m(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}var x="http://www.w3.org/2000/svg",h=(function(){function l(t,r,s){m(this,l),this.svg=t,this.encodings=r,this.options=s,this.document=s.xmlDocument||document}return d(l,[{key:"render",value:function(){var r=this.options.marginLeft;this.prepareSVG();for(var s=0;s<this.encodings.length;s++){var a=this.encodings[s],n=(0,b.default)(this.options,a.options),o=this.createGroup(r,n.marginTop,this.svg);this.setGroupOptions(o,n),this.drawSvgBarcode(o,n,a),this.drawSVGText(o,n,a),r+=a.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,i.calculateEncodingAttributes)(this.encodings,this.options);var r=(0,i.getTotalWidthOfEncodings)(this.encodings),s=(0,i.getMaximumHeightOfEncodings)(this.encodings),a=r+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(a,s),this.options.background&&this.drawRect(0,0,a,s,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(r,s,a){var n=a.data,o;s.textPosition=="top"?o=s.fontSize+s.textMargin:o=0;for(var u=0,g=0,k=0;k<n.length;k++)g=k*s.width+a.barcodePadding,n[k]==="1"?u++:u>0&&(this.drawRect(g-s.width*u,o,s.width*u,s.height,r),u=0);u>0&&this.drawRect(g-s.width*(u-1),o,s.width*u,s.height,r)}},{key:"drawSVGText",value:function(r,s,a){var n=this.document.createElementNS(x,"text");if(s.displayValue){var o,u;n.setAttribute("style","font:"+s.fontOptions+" "+s.fontSize+"px "+s.font),s.textPosition=="top"?u=s.fontSize-s.textMargin:u=s.height+s.textMargin+s.fontSize,s.textAlign=="left"||a.barcodePadding>0?(o=0,n.setAttribute("text-anchor","start")):s.textAlign=="right"?(o=a.width-1,n.setAttribute("text-anchor","end")):(o=a.width/2,n.setAttribute("text-anchor","middle")),n.setAttribute("x",o),n.setAttribute("y",u),n.appendChild(this.document.createTextNode(a.text)),r.appendChild(n)}}},{key:"setSvgAttributes",value:function(r,s){var a=this.svg;a.setAttribute("width",r+"px"),a.setAttribute("height",s+"px"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("viewBox","0 0 "+r+" "+s),a.setAttribute("xmlns",x),a.setAttribute("version","1.1"),a.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(r,s,a){var n=this.document.createElementNS(x,"g");return n.setAttribute("transform","translate("+r+", "+s+")"),a.appendChild(n),n}},{key:"setGroupOptions",value:function(r,s){r.setAttribute("style","fill:"+s.lineColor+";")}},{key:"drawRect",value:function(r,s,a,n,o){var u=this.document.createElementNS(x,"rect");return u.setAttribute("x",r),u.setAttribute("y",s),u.setAttribute("width",a),u.setAttribute("height",n),o.appendChild(u),u}}]),l})();return Yt.default=h,Yt}var Jt={},Sa;function hn(){if(Sa)return Jt;Sa=1,Object.defineProperty(Jt,"__esModule",{value:!0});var d=(function(){function i(c,m){for(var x=0;x<m.length;x++){var h=m[x];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}return function(c,m,x){return m&&i(c.prototype,m),x&&i(c,x),c}})();function f(i,c){if(!(i instanceof c))throw new TypeError("Cannot call a class as a function")}var b=(function(){function i(c,m,x){f(this,i),this.object=c,this.encodings=m,this.options=x}return d(i,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),i})();return Jt.default=b,Jt}var Ca;function xn(){if(Ca)return Wt;Ca=1,Object.defineProperty(Wt,"__esModule",{value:!0});var d=cn(),f=x(d),b=un(),i=x(b),c=hn(),m=x(c);function x(h){return h&&h.__esModule?h:{default:h}}return Wt.default={CanvasRenderer:f.default,SVGRenderer:i.default,ObjectRenderer:m.default},Wt}var et={},Ea;function Ka(){if(Ea)return et;Ea=1,Object.defineProperty(et,"__esModule",{value:!0});function d(x,h){if(!(x instanceof h))throw new TypeError("Cannot call a class as a function")}function f(x,h){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:x}function b(x,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);x.prototype=Object.create(h&&h.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(x,h):x.__proto__=h)}var i=(function(x){b(h,x);function h(l,t){d(this,h);var r=f(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return r.name="InvalidInputException",r.symbology=l,r.input=t,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return h})(Error),c=(function(x){b(h,x);function h(){d(this,h);var l=f(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return l.name="InvalidElementException",l.message="Not supported type to render on",l}return h})(Error),m=(function(x){b(h,x);function h(){d(this,h);var l=f(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return l.name="NoElementException",l.message="No element to render on.",l}return h})(Error);return et.InvalidInputException=i,et.InvalidElementException=c,et.NoElementException=m,et}var Pa;function mn(){if(Pa)return Vt;Pa=1,Object.defineProperty(Vt,"__esModule",{value:!0});var d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},f=dn(),b=x(f),i=xn(),c=x(i),m=Ka();function x(r){return r&&r.__esModule?r:{default:r}}function h(r){if(typeof r=="string")return l(r);if(Array.isArray(r)){for(var s=[],a=0;a<r.length;a++)s.push(h(r[a]));return s}else{if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLImageElement)return t(r);if(r&&r.nodeName&&r.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&r instanceof SVGElement)return{element:r,options:(0,b.default)(r),renderer:c.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement)return{element:r,options:(0,b.default)(r),renderer:c.default.CanvasRenderer};if(r&&r.getContext)return{element:r,renderer:c.default.CanvasRenderer};if(r&&(typeof r>"u"?"undefined":d(r))==="object"&&!r.nodeName)return{element:r,renderer:c.default.ObjectRenderer};throw new m.InvalidElementException}}function l(r){var s=document.querySelectorAll(r);if(s.length!==0){for(var a=[],n=0;n<s.length;n++)a.push(h(s[n]));return a}}function t(r){var s=document.createElement("canvas");return{element:s,options:(0,b.default)(r),renderer:c.default.CanvasRenderer,afterRender:function(){r.setAttribute("src",s.toDataURL())}}}return Vt.default=h,Vt}var Zt={},Oa;function fn(){if(Oa)return Zt;Oa=1,Object.defineProperty(Zt,"__esModule",{value:!0});var d=(function(){function i(c,m){for(var x=0;x<m.length;x++){var h=m[x];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}return function(c,m,x){return m&&i(c.prototype,m),x&&i(c,x),c}})();function f(i,c){if(!(i instanceof c))throw new TypeError("Cannot call a class as a function")}var b=(function(){function i(c){f(this,i),this.api=c}return d(i,[{key:"handleCatch",value:function(m){if(m.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw m.message;else throw m;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(m){try{var x=m.apply(void 0,arguments);return this.api._options.valid(!0),x}catch(h){return this.handleCatch(h),this.api}}}]),i})();return Zt.default=b,Zt}var ur,Ma;function bn(){if(Ma)return ur;Ma=1;var d=nn(),f=k(d),b=lr(),i=k(b),c=ln(),m=k(c),x=on(),h=k(x),l=mn(),t=k(l),r=Ga(),s=k(r),a=fn(),n=k(a),o=Ka(),u=Va(),g=k(u);function k(S){return S&&S.__esModule?S:{default:S}}var v=function(){},E=function(M,L,P){var D=new v;if(typeof M>"u")throw Error("No element to render on was provided.");return D._renderProperties=(0,t.default)(M),D._encodings=[],D._options=g.default,D._errorHandler=new n.default(D),typeof L<"u"&&(P=P||{},P.format||(P.format=C()),D.options(P)[P.format](L,P).render()),D};E.getModule=function(S){return f.default[S]};for(var O in f.default)f.default.hasOwnProperty(O)&&B(f.default,O);function B(S,M){v.prototype[M]=v.prototype[M.toUpperCase()]=v.prototype[M.toLowerCase()]=function(L,P){var D=this;return D._errorHandler.wrapBarcodeCall(function(){P.text=typeof P.text>"u"?void 0:""+P.text;var $=(0,i.default)(D._options,P);$=(0,s.default)($);var z=S[M],H=w(L,z,$);return D._encodings.push(H),D})}}function w(S,M,L){S=""+S;var P=new M(S,L);if(!P.valid())throw new o.InvalidInputException(P.constructor.name,S);var D=P.encode();D=(0,m.default)(D);for(var $=0;$<D.length;$++)D[$].options=(0,i.default)(L,D[$].options);return D}function C(){return f.default.CODE128?"CODE128":Object.keys(f.default)[0]}v.prototype.options=function(S){return this._options=(0,i.default)(this._options,S),this},v.prototype.blank=function(S){var M=new Array(S+1).join("0");return this._encodings.push({data:M}),this},v.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var S;for(var M in this._renderProperties){S=this._renderProperties[M];var L=(0,i.default)(this._options,S.options);L.format=="auto"&&(L.format=C()),this._errorHandler.wrapBarcodeCall(function(){var P=L.value,D=f.default[L.format.toUpperCase()],$=w(P,D,L);_(S,$,L)})}}},v.prototype.render=function(){if(!this._renderProperties)throw new o.NoElementException;if(Array.isArray(this._renderProperties))for(var S=0;S<this._renderProperties.length;S++)_(this._renderProperties[S],this._encodings,this._options);else _(this._renderProperties,this._encodings,this._options);return this},v.prototype._defaults=g.default;function _(S,M,L){M=(0,m.default)(M);for(var P=0;P<M.length;P++)M[P].options=(0,i.default)(L,M[P].options),(0,h.default)(M[P].options);(0,h.default)(L);var D=S.renderer,$=new D(S.element,M,L);$.render(),S.afterRender&&S.afterRender()}return typeof window<"u"&&(window.JsBarcode=E),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(S,M){var L=[];return jQuery(this).each(function(){L.push(this)}),E(L,S,M)}),ur=E,ur}var gn=bn();const rt=as(gn),hr={"30x20":{width:30,height:20,name:"30√ó20mm (nh·ªè)",barcodeHeight:25,fontSize:7},"40x30":{width:40,height:30,name:"40√ó30mm (ph·ªï bi·∫øn)",barcodeHeight:35,fontSize:8},"50x30":{width:50,height:30,name:"50√ó30mm (v·ª´a)",barcodeHeight:40,fontSize:9},"60x40":{width:60,height:40,name:"60√ó40mm (l·ªõn)",barcodeHeight:45,fontSize:10},"80x50":{width:80,height:50,name:"80√ó50mm (max)",barcodeHeight:55,fontSize:12}},pn=({part:d,currentBranchId:f,onClose:b})=>{const i=y.useRef(null),c=y.useRef(null),[m,x]=y.useState(1),[h,l]=y.useState(!0),[t,r]=y.useState(!0),[s,a]=y.useState("40x30"),[n,o]=y.useState("CODE128"),[u,g]=y.useState(1),k=d.barcode||d.sku||d.id.slice(0,12),v=hr[s];y.useEffect(()=>{if(i.current)try{const O=Math.max(1,(v.width-10)/50);rt(i.current,k,{format:n,width:O,height:v.barcodeHeight,displayValue:!0,fontSize:v.fontSize,margin:2,textMargin:1,font:"monospace"})}catch(O){console.error("Barcode generation error:",O),rt(i.current,k,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}},[k,n,s,v]);const E=()=>{if(!c.current)return;const B=window.open("","_blank");if(!B){alert("Vui l√≤ng cho ph√©p popup ƒë·ªÉ in");return}const w=Math.floor(v.width/3),C=d.name.length>w?d.name.slice(0,w)+"...":d.name,_=Array(m).fill(null).map(()=>{var S;return`
        <div class="label" style="
          width: ${v.width}mm;
          height: ${v.height}mm;
          padding: 1mm;
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          page-break-inside: avoid;
          box-sizing: border-box;
          overflow: hidden;
        ">
          ${t?`<div style="font-size: ${v.fontSize-1}px; font-weight: bold; text-align: center; line-height: 1.1; max-width: 100%; overflow: hidden; white-space: nowrap;">${C}</div>`:""}
          ${((S=i.current)==null?void 0:S.outerHTML)||""}
          ${h?`<div style="font-size: ${v.fontSize}px; font-weight: bold; line-height: 1;">${W(d.retailPrice[f]||0)}</div>`:""}
        </div>
      `}).join("");B.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>In m√£ v·∫°ch - ${d.name}</title>
          <style>
            @page {
              size: ${v.width}mm ${v.height}mm;
              margin: 0;
            }
            * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
            }
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
              width: ${v.width*u}mm;
            }
            .labels-container {
              display: flex;
              flex-wrap: wrap;
              width: 100%;
            }
            .label {
              border: none;
            }
            svg {
              max-width: ${v.width-4}mm !important;
              height: auto !important;
            }
            @media print {
              body { 
                margin: 0; 
                padding: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
              }
              .label { 
                page-break-after: always;
              }
              .label:last-child {
                page-break-after: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="labels-container">
            ${_}
          </div>
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
                window.onafterprint = function() { window.close(); };
              }, 200);
            };
          <\/script>
        </body>
      </html>
    `),B.document.close()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(rr,{className:"w-5 h-5 text-blue-600"}),"In m√£ v·∫°ch n·ªôi b·ªô"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Xprinter XP-360B (20-82mm)"})]}),e.jsx("button",{onClick:b,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(fr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:d.name}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mt-1",children:["M√£: ",k]}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 font-semibold mt-1",children:W(d.retailPrice[f]||0)})]}),e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 flex flex-col items-center bg-white",children:[e.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Xem tr∆∞·ªõc nh√£n (",v.name,")"]}),e.jsxs("div",{ref:c,className:"border-2 border-dashed border-slate-300 rounded flex flex-col items-center justify-center bg-white",style:{width:`${v.width}mm`,height:`${v.height}mm`,padding:"1mm"},children:[t&&e.jsx("p",{className:"font-bold text-center text-slate-900 truncate max-w-full leading-tight",style:{fontSize:`${v.fontSize-1}px`},children:d.name.length>Math.floor(v.width/3)?d.name.slice(0,Math.floor(v.width/3))+"...":d.name}),e.jsx("svg",{ref:i,className:"max-w-full"}),h&&e.jsx("p",{className:"font-bold text-slate-900 leading-tight",style:{fontSize:`${v.fontSize}px`},children:W(d.retailPrice[f]||0)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"K√≠ch th∆∞·ªõc nh√£n (ph√π h·ª£p XP-360B)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(hr).map(O=>e.jsx("button",{onClick:()=>a(O),className:`px-3 py-2 text-xs rounded-lg transition-colors text-left ${s===O?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:hr[O].name},O))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"S·ªë l∆∞·ª£ng nh√£n"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>x(Math.max(1,m-1)),className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(gs,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",value:m,onChange:O=>x(Math.max(1,parseInt(O.target.value)||1)),className:"w-16 text-center px-2 py-1 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"1",max:"100"}),e.jsx("button",{onClick:()=>x(Math.min(100,m+1)),className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(tr,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Lo·∫°i m√£ v·∫°ch"}),e.jsxs("select",{value:n,onChange:O=>o(O.target.value),className:"px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"CODE128",children:"CODE128 (ph·ªï bi·∫øn)"}),e.jsx("option",{value:"CODE39",children:"CODE39"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:O=>r(O.target.checked),className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Hi·ªán t√™n"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:O=>l(O.target.checked),className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Hi·ªán gi√°"})]})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-300",children:[e.jsx("strong",{children:"üí° M·∫πo:"})," C√†i ƒë·∫∑t kh·ªï gi·∫•y trong driver m√°y in tr√πng v·ªõi k√≠ch th∆∞·ªõc nh√£n ƒë√£ ch·ªçn ƒë·ªÉ in ch√≠nh x√°c."]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(rr,{className:"w-4 h-4"}),"In ",m," nh√£n"]})]})]})})},xr={"30x20":{width:30,height:20,name:"30√ó20mm",barcodeHeight:25,fontSize:7},"40x30":{width:40,height:30,name:"40√ó30mm",barcodeHeight:35,fontSize:8},"50x30":{width:50,height:30,name:"50√ó30mm",barcodeHeight:40,fontSize:9},"60x40":{width:60,height:40,name:"60√ó40mm",barcodeHeight:45,fontSize:10},"80x50":{width:80,height:50,name:"80√ó50mm",barcodeHeight:55,fontSize:12}},vn=({value:d,format:f,size:b})=>{const i=y.useRef(null);return y.useEffect(()=>{if(i.current)try{rt(i.current,d,{format:f,width:1.5,height:b.barcodeHeight,displayValue:!0,fontSize:b.fontSize,margin:2,textMargin:1,font:"monospace"})}catch{rt(i.current,d,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}},[d,f,b]),e.jsx("svg",{ref:i,className:"max-w-full h-auto"})},kn=({parts:d,currentBranchId:f,onClose:b})=>{const[i,c]=y.useState("select"),[m,x]=y.useState(new Map),[h,l]=y.useState(""),[t,r]=y.useState("all"),[s,a]=y.useState("40x30"),[n,o]=y.useState("CODE128"),[u,g]=y.useState(!0),[k,v]=y.useState(!0),[E,O]=y.useState("stock"),[B,w]=y.useState(1),[C,_]=y.useState(0),S=6,M=y.useMemo(()=>{const p=new Set;return d.forEach(A=>{A.category&&p.add(A.category)}),Array.from(p).sort()},[d]),L=y.useMemo(()=>d.filter(p=>{var oe,Ce;const A=!h||p.name.toLowerCase().includes(h.toLowerCase())||((oe=p.sku)==null?void 0:oe.toLowerCase().includes(h.toLowerCase()))||((Ce=p.barcode)==null?void 0:Ce.toLowerCase().includes(h.toLowerCase())),Q=t==="all"||p.category===t;return A&&Q}),[d,h,t]),P=p=>p.stock[f]||0,D=p=>{const A=new Map(m);if(A.has(p.id))A.delete(p.id);else{const Q=E==="stock"?Math.max(1,P(p)):E==="fixed"?B:1;A.set(p.id,{part:p,quantity:Q})}x(A)},$=()=>{const p=new Map(m);L.forEach(A=>{if(!p.has(A.id)){const Q=E==="stock"?Math.max(1,P(A)):E==="fixed"?B:1;p.set(A.id,{part:A,quantity:Q})}}),x(p)},z=()=>{x(new Map)},H=(p,A)=>{const Q=new Map(m),oe=Q.get(p);oe&&(Q.set(p,{...oe,quantity:Math.max(1,A)}),x(Q))},te=()=>{const p=new Map;m.forEach((A,Q)=>{const oe=E==="stock"?Math.max(1,P(A.part)):E==="fixed"?B:A.quantity;p.set(Q,{...A,quantity:oe})}),x(p)},ce=y.useMemo(()=>{let p=0;return m.forEach(A=>{p+=A.quantity}),p},[m]),de=y.useMemo(()=>{const p=[];return m.forEach(({part:A,quantity:Q})=>{for(let oe=0;oe<Q;oe++)p.push({part:A,index:oe})}),p},[m]),Y=y.useMemo(()=>{const p=C*S;return de.slice(p,p+S)},[de,C,S]),ee=Math.ceil(de.length/S),U=xr[s],ue=p=>{const A=document.createElementNS("http://www.w3.org/2000/svg","svg");try{rt(A,p,{format:n,width:Math.max(1,(U.width-10)/50),height:U.barcodeHeight,displayValue:!0,fontSize:U.fontSize,margin:2,textMargin:1,font:"monospace"})}catch{rt(A,p,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}return A.outerHTML},T=()=>{if(m.size===0){alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 s·∫£n ph·∫©m");return}const p=window.open("","_blank");if(!p){alert("Vui l√≤ng cho ph√©p popup ƒë·ªÉ in");return}let A="";m.forEach(({part:Q,quantity:oe})=>{const Ce=Q.barcode||Q.sku||Q.id.slice(0,12),Me=ue(Ce);for(let ie=0;ie<oe;ie++)A+=`
          <div class="label" style="
            width: ${U.width}mm;
            height: ${U.height}mm;
            padding: 1mm;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            page-break-inside: avoid;
            box-sizing: border-box;
            overflow: hidden;
          ">
            ${k?`<div style="font-size: ${Math.max(7,U.fontSize-1)}px; font-weight: bold; text-align: center; line-height: 1.2; max-width: 100%; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; word-break: break-word;">${Q.name}</div>`:""}
            ${Me}
            ${u?`<div style="font-size: ${U.fontSize}px; font-weight: bold; line-height: 1;">${W(Q.retailPrice[f]||0)}</div>`:""}
          </div>
        `}),p.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>In m√£ v·∫°ch h√†ng lo·∫°t - ${m.size} s·∫£n ph·∫©m</title>
          <style>
            @page {
              size: ${U.width}mm ${U.height}mm;
              margin: 0;
            }
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
            }
            .labels-container {
              display: flex;
              flex-wrap: wrap;
              width: 100%;
            }
            .label { border: none; }
            svg { max-width: ${U.width-4}mm !important; height: auto !important; }
            @media print {
              body { margin: 0; padding: 0; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
              .label { page-break-after: always; }
              .label:last-child { page-break-after: avoid; }
            }
          </style>
        </head>
        <body>
          <div class="labels-container">${A}</div>
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
                window.onafterprint = function() { window.close(); };
              }, 300);
            };
          <\/script>
        </body>
      </html>
    `),p.document.close()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 md:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(rr,{className:"w-5 h-5 text-blue-600"}),"In m√£ v·∫°ch h√†ng lo·∫°t"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:i==="select"?"B∆∞·ªõc 1: Ch·ªçn s·∫£n ph·∫©m v√† c√†i ƒë·∫∑t":"B∆∞·ªõc 2: Xem tr∆∞·ªõc v√† ch·ªânh s·ª≠a"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-700 rounded-lg p-0.5",children:[e.jsxs("button",{onClick:()=>c("select"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors flex items-center gap-1.5 ${i==="select"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx(ys,{className:"w-3.5 h-3.5"}),"Ch·ªçn SP"]}),e.jsxs("button",{onClick:()=>{c("preview"),_(0)},disabled:m.size===0,className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors flex items-center gap-1.5 ${i==="preview"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[e.jsx(Sr,{className:"w-3.5 h-3.5"}),"Xem tr∆∞·ªõc"]})]}),e.jsx("button",{onClick:b,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(fr,{className:"w-5 h-5"})})]})]}),i==="select"?e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 space-y-2 shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:h,onChange:p=>l(p.target.value),placeholder:"T√¨m s·∫£n ph·∫©m, SKU, m√£ v·∫°ch...",className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:t,onChange:p=>r(p.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),M.map(p=>e.jsx("option",{value:p,children:p},p))]}),e.jsx("button",{onClick:$,className:"px-3 py-1.5 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50",children:"Ch·ªçn t·∫•t c·∫£"}),e.jsx("button",{onClick:z,className:"px-3 py-1.5 text-xs bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600",children:"B·ªè ch·ªçn"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:L.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}):e.jsx("div",{className:"space-y-1",children:L.map(p=>{const A=m.has(p.id),Q=P(p);return e.jsxs("div",{onClick:()=>D(p),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors ${A?"bg-blue-50 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-700":"bg-slate-50 dark:bg-slate-900/50 border border-transparent hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center shrink-0 ${A?"bg-blue-600 text-white":"border-2 border-slate-300 dark:border-slate-600"}`,children:A&&e.jsx(ss,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:p.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:p.barcode||p.sku})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªìn kho"}),e.jsx("p",{className:`text-sm font-bold ${Q>0?"text-green-600":"text-red-500"}`,children:Q})]})]},p.id)})})})]}),e.jsxs("div",{className:"w-full md:w-80 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 space-y-3 shrink-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"C√†i ƒë·∫∑t in"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"S·ªë l∆∞·ª£ng nh√£n"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{O("stock")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="stock"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"= T·ªìn kho"}),e.jsx("button",{onClick:()=>{O("fixed")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="fixed"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"C·ªë ƒë·ªãnh"}),e.jsx("button",{onClick:()=>{O("custom")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="custom"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"T√πy ch·ªânh"})]}),E==="fixed"&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"M·ªói SP in:"}),e.jsx("input",{type:"number",value:B,onChange:p=>w(Math.max(1,parseInt(p.target.value)||1)),className:"w-16 px-2 py-1 text-sm text-center border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",min:"1"}),e.jsx("span",{className:"text-xs text-slate-500",children:"nh√£n"})]}),m.size>0&&E!=="custom"&&e.jsxs("button",{onClick:te,className:"mt-2 w-full px-2 py-1 text-xs bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 rounded hover:bg-amber-200",children:["√Åp d·ª•ng cho ",m.size," SP ƒë√£ ch·ªçn"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"K√≠ch th∆∞·ªõc nh√£n"}),e.jsx("select",{value:s,onChange:p=>a(p.target.value),className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700",children:Object.entries(xr).map(([p,A])=>e.jsx("option",{value:p,children:A.name},p))})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:p=>v(p.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"T√™n"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:p=>g(p.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"Gi√°"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[e.jsxs("h3",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 mb-2 px-1",children:["ƒê√£ ch·ªçn: ",m.size," SP ‚Ä¢ ",ce," nh√£n"]}),m.size===0?e.jsxs("div",{className:"text-center py-4 text-slate-400 text-xs",children:[e.jsx(er,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Ch∆∞a ch·ªçn s·∫£n ph·∫©m n√†o"]}):e.jsx("div",{className:"space-y-1",children:Array.from(m.values()).map(({part:p,quantity:A})=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-xs font-medium text-slate-900 dark:text-slate-100 truncate",children:p.name})}),E==="custom"?e.jsx("input",{type:"number",value:A,onChange:Q=>H(p.id,parseInt(Q.target.value)||1),onClick:Q=>Q.stopPropagation(),className:"w-14 px-1 py-0.5 text-xs text-center border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",min:"1"}):e.jsxs("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:["√ó",A]}),e.jsx("button",{onClick:Q=>{Q.stopPropagation(),D(p)},className:"text-red-500 hover:text-red-700",children:e.jsx(fr,{className:"w-4 h-4"})})]},p.id))})]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 flex flex-wrap items-center gap-3 shrink-0 bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"K√≠ch th∆∞·ªõc:"}),e.jsx("select",{value:s,onChange:p=>a(p.target.value),className:"px-2 py-1 text-sm border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",children:Object.entries(xr).map(([p,A])=>e.jsx("option",{value:p,children:A.name},p))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:p=>v(p.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"T√™n SP"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:p=>g(p.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"Gi√°"})]})]}),e.jsxs("div",{className:"ml-auto text-xs text-slate-500 dark:text-slate-400",children:["T·ªïng:"," ",e.jsx("span",{className:"font-bold text-blue-600",children:ce})," ","nh√£n"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-slate-100 dark:bg-slate-900",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 max-w-3xl mx-auto",children:Y.map(({part:p,index:A})=>{const Q=p.barcode||p.sku||p.id.slice(0,12);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-md p-2 flex flex-col items-center justify-center border-2 border-dashed border-slate-300 dark:border-slate-600",style:{minHeight:`${U.height*2.5}px`,aspectRatio:`${U.width}/${U.height}`},children:[k&&e.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-slate-100 text-center w-full mb-1 line-clamp-2 leading-tight",style:{fontSize:`${Math.max(9,U.fontSize-1)}px`},children:p.name}),e.jsx(vn,{value:Q,format:n,size:U}),u&&e.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-slate-100 mt-1",children:W(p.retailPrice[f]||0)})]},`${p.id}-${A}`)})})}),ee>1&&e.jsxs("div",{className:"flex items-center justify-center gap-3 p-3 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("button",{onClick:()=>_(p=>Math.max(0,p-1)),disabled:C===0,className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(Er,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Trang ",e.jsx("span",{className:"font-bold",children:C+1})," /"," ",ee]}),e.jsx("button",{onClick:()=>_(p=>Math.min(ee-1,p+1)),disabled:C>=ee-1,className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(ns,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-slate-200 dark:border-slate-700 shrink-0",children:[e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("span",{className:"font-semibold text-blue-600",children:m.size})," ","s·∫£n ph·∫©m ‚Ä¢",e.jsx("span",{className:"font-semibold text-green-600 ml-1",children:ce})," ","nh√£n"]}),e.jsx("div",{className:"flex gap-3",children:i==="select"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:()=>{c("preview"),_(0)},disabled:m.size===0,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed rounded-lg flex items-center gap-2",children:[e.jsx(Sr,{className:"w-4 h-4"}),"Xem tr∆∞·ªõc (",ce,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c("select"),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg flex items-center gap-2",children:[e.jsx(Er,{className:"w-4 h-4"}),"Quay l·∫°i ch·ªânh s·ª≠a"]}),e.jsxs("button",{onClick:T,disabled:m.size===0,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed rounded-lg flex items-center gap-2",children:[e.jsx(rr,{className:"w-4 h-4"}),"In ",ce," nh√£n"]})]})})]})]})})},Be=5,Xa=({isOpen:d,onClose:f,onSave:b})=>{const[i,c]=y.useState(""),[m,x]=y.useState(""),[h,l]=y.useState(""),[t,r]=y.useState(""),[s,a]=y.useState(1),[n,o]=y.useState(0),[u,g]=y.useState(0),[k,v]=y.useState(0),[E,O]=y.useState("th√°ng"),[B,w]=y.useState(!1),{data:C=[]}=kr(),_=Ia(),[S,M]=y.useState(!1),[L,P]=y.useState(""),D=()=>{if(!i.trim()){q.warning("Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m");return}b({name:i.trim(),description:m.trim(),barcode:h.trim(),category:t||"Ch∆∞a ph√¢n lo·∫°i",quantity:Number(s)||1,importPrice:Number(n)||0,retailPrice:Number(u)||0,warranty:Number(k)||0,warrantyUnit:E}),c(""),x(""),l(""),r(""),a(1),o(0),g(0),v(0),w(!1),O("th√°ng")};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-xl max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:"Th√™m s·∫£n ph·∫©m m·ªõi"}),e.jsx("button",{onClick:f,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-xl",children:"√ó"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1",children:["T√™n s·∫£n ph·∫©m ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i,onChange:$=>c($.target.value),className:"w-full px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"Nh·∫≠p t√™n s·∫£n ph·∫©m"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Danh m·ª•c s·∫£n ph·∫©m"}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsxs("select",{value:t,onChange:$=>r($.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"-- Ch·ªçn ho·∫∑c t·∫°o m·ªõi --"}),C.map($=>e.jsx("option",{value:$.name,children:$.name},$.id))]}),e.jsx("button",{type:"button",onClick:()=>M(!0),className:"w-8 h-8 flex items-center justify-center bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-600","aria-label":"Th√™m danh m·ª•c m·ªõi",children:e.jsx("span",{className:"text-lg text-slate-600 dark:text-slate-300",children:"+"})})]})]})]}),S&&e.jsxs("form",{onSubmit:async $=>{$.preventDefault();const z=L.trim();if(!z){q.warning("Vui l√≤ng nh·∫≠p t√™n danh m·ª•c");return}if(z.length<2){q.warning("T√™n qu√° ng·∫Øn");return}try{const H=await _.mutateAsync({name:z});r(H.name),P(""),M(!1)}catch(H){q.error((H==null?void 0:H.message)||"L·ªói t·∫°o danh m·ª•c")}},className:"flex gap-2",children:[e.jsx("input",{autoFocus:!0,type:"text",value:L,onChange:$=>P($.target.value),placeholder:"Nh·∫≠p t√™n danh m·ª•c m·ªõi",className:"flex-1 px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsx("button",{type:"submit",className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-medium",children:"L∆∞u"}),e.jsx("button",{type:"button",onClick:()=>{M(!1),P("")},className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg text-xs bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-600",children:"H·ªßy"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1",children:"M√¥ t·∫£"}),e.jsx("textarea",{value:m,onChange:$=>x($.target.value),rows:2,className:"w-full px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"M√¥ t·∫£ s·∫£n ph·∫©m"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1",children:"M√£ s·∫£n ph·∫©m"}),e.jsx("input",{type:"text",value:h,onChange:$=>l($.target.value),placeholder:"VD: 06455-KYJ-841 (Honda), 5S9-F2101-00 (Yamaha)",className:"w-full px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 font-mono"}),e.jsx("p",{className:"mt-0.5 text-[10px] text-slate-500 dark:text-slate-400",children:"Nh·∫≠p m√£ h√£ng (Honda/Yamaha) ho·∫∑c ƒë·ªÉ tr·ªëng ƒë·ªÉ t·ª± sinh m√£ n·ªôi b·ªô PT-xxxxx"})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Th√¥ng tin nh·∫≠p kho:"}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-slate-600 dark:text-slate-400 mb-0.5",children:"S·ªë l∆∞·ª£ng"}),e.jsx(qe,{value:s,onValue:$=>{const z=br(n,$);z.warnings.length&&z.warnings.forEach(H=>q.warning(H)),a(Math.max(1,z.clean.quantity))},className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-slate-600 dark:text-slate-400 mb-0.5",children:"Gi√° nh·∫≠p"}),e.jsx(qe,{value:n,onValue:$=>{const z=br($,s);z.warnings.length&&z.warnings.forEach(H=>q.warning(H)),o(z.clean.importPrice),B||g(Math.round(z.clean.importPrice*1.5))},className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-slate-600 dark:text-slate-400 mb-0.5",children:"Gi√° b√°n l·∫ª"}),e.jsx(qe,{value:u,onValue:$=>{g(Math.max(0,Math.round($))),w(!0)},className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-slate-600 dark:text-slate-400 mb-0.5",children:"B·∫£o h√†nh"}),e.jsx(qe,{value:k,onValue:$=>v(Math.max(0,Math.floor($))),className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-slate-600 dark:text-slate-400 mb-0.5",children:"ƒê∆°n v·ªã"}),e.jsxs("select",{value:E,onChange:$=>O($.target.value),className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"th√°ng",children:"th√°ng"}),e.jsx("option",{value:"nƒÉm",children:"nƒÉm"}),e.jsx("option",{value:"ng√†y",children:"ng√†y"})]})]})]})]})]})}),e.jsx("div",{className:"px-4 py-3 border-t border-slate-200 dark:border-slate-700",children:e.jsx("button",{onClick:D,className:"w-full bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg font-medium text-sm",children:"L∆∞u v√† Th√™m v√†o gi·ªè h√†ng"})})]})}):null},yn=({isOpen:d,onClose:f,parts:b,currentBranchId:i,onSave:c})=>{const[m,x]=y.useState([]),[h,l]=y.useState(""),[t,r]=y.useState(""),[s,a]=y.useState(0),[n,o]=y.useState("amount"),[u,g]=y.useState("cash"),[k,v]=y.useState("full"),[E,O]=y.useState(0),[B,w]=y.useState(!1),C=vr();console.log("üì¶ GoodsReceiptMobileWrapper - parts received:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üì¶ currentBranchId:",i),y.useEffect(()=>{d||(x([]),l(""),r(""),a(0),o("amount"),g("cash"),v("full"),O(0))},[d]);const _=M=>{(async()=>{var L;try{const P=await C.mutateAsync({name:M.name,sku:M.sku||`PT-${Date.now()}`,barcode:M.barcode||"",category:M.category,stock:{[i]:M.quantity},costPrice:{[i]:M.importPrice},retailPrice:{[i]:M.retailPrice},wholesalePrice:{[i]:M.wholesalePrice||0}});if(!P.ok)throw new Error(((L=P.error)==null?void 0:L.message)||"Failed to create part");x(D=>[...D,{partId:P.data.id,partName:M.name,sku:M.sku||`PT-${Date.now()}`,quantity:M.quantity,importPrice:M.importPrice,sellingPrice:M.retailPrice,wholesalePrice:M.wholesalePrice||0}]),q.success("ƒê√£ t·∫°o ph·ª• t√πng m·ªõi v√† th√™m v√†o phi·∫øu nh·∫≠p")}catch(P){q.error((P==null?void 0:P.message)||"L·ªói t·∫°o ph·ª• t√πng m·ªõi")}finally{w(!1)}})()},S=()=>{if(!h){q.error("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}if(m.length===0){q.error("Vui l√≤ng th√™m s·∫£n ph·∫©m");return}const M=m.reduce(($,z)=>$+z.quantity*z.importPrice,0),L=n==="percent"?Math.round(M*s/100):s,P=Math.max(0,M-L);let D=0;k==="full"?D=P:k==="partial"&&(D=E),c(m,h,P,"",{paymentMethod:u,paymentType:k,paidAmount:D,discount:L}),clearDraft(),f()};return e.jsxs(e.Fragment,{children:[e.jsx(Os,{isOpen:d,onClose:f,parts:b,receiptItems:m,setReceiptItems:x,selectedSupplier:h,setSelectedSupplier:l,searchTerm:t,setSearchTerm:r,onSave:S,discount:s,setDiscount:a,discountType:n,setDiscountType:o,paymentMethod:u,setPaymentMethod:g,paymentType:k,setPaymentType:v,partialAmount:E,setPartialAmount:O,showAddProductModal:B,setShowAddProductModal:w,onAddNewProduct:_,currentBranchId:i}),e.jsx(Xa,{isOpen:B,onClose:()=>w(!1),onSave:_})]})},jn=({isOpen:d,onClose:f,parts:b,currentBranchId:i,onSave:c})=>{const[m,x]=y.useState(""),[h,l]=y.useState(""),t=y.useRef(null),[r,s]=y.useState(!1),[a,n]=y.useState(!1),[o,u]=y.useState(""),[g,k]=y.useState(1),{data:v=[]}=yr(),E=qa(),[O,B]=y.useState(!1),[w,C]=y.useState({name:"",phone:"",address:"",note:""}),_=vr(),[S,M]=y.useState(!1),[L,P]=y.useState([]),[D,$]=y.useState(null),[z,H]=y.useState(null),[te,ce]=y.useState(0),[de,Y]=y.useState(0),[ee,U]=y.useState("amount"),[ue,T]=y.useState(0),p=`goods_receipt_draft_${i}`;y.useEffect(()=>{var N,G;if(d)try{const Z=localStorage.getItem(p);if(Z){const K=JSON.parse(Z);K.timestamp&&Date.now()-K.timestamp<1440*60*1e3?(((N=K.receiptItems)==null?void 0:N.length)>0||K.selectedSupplier)&&(window.confirm(`Ph√°t hi·ªán phi·∫øu nh·∫≠p ch∆∞a ho√†n t·∫•t (${((G=K.receiptItems)==null?void 0:G.length)||0} s·∫£n ph·∫©m).

B·∫°n c√≥ mu·ªën kh√¥i ph·ª•c kh√¥ng?`)?(P(K.receiptItems||[]),u(K.selectedSupplier||""),Y(K.discount||0),U(K.discountType||"amount"),T(K.discountPercent||0),q.success("ƒê√£ kh√¥i ph·ª•c phi·∫øu nh·∫≠p t·ª´ b·∫£n nh√°p")):localStorage.removeItem(p)):localStorage.removeItem(p)}}catch(Z){console.error("L·ªói kh√¥i ph·ª•c draft:",Z)}},[d,p]),y.useEffect(()=>{if(d&&(L.length>0||o)){const N={receiptItems:L,selectedSupplier:o,discount:de,discountType:ee,discountPercent:ue,timestamp:Date.now()};localStorage.setItem(p,JSON.stringify(N))}},[d,L,o,de,ee,ue,p]);const A=()=>{localStorage.removeItem(p)},Q=y.useMemo(()=>{if(console.log("üîç Desktop Modal - parts:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üîç Desktop Modal - searchTerm:",m),!b||b.length===0)return console.log("‚ö†Ô∏è parts is empty or undefined"),[];if(!m||m.trim()==="")return console.log("‚úÖ Showing all parts:",b.length),b;const N=m.toLowerCase().trim(),G=b.filter(Z=>{var K,ae;return((K=Z.name)==null?void 0:K.toLowerCase().includes(N))||((ae=Z.sku)==null?void 0:ae.toLowerCase().includes(N))});return console.log("‚úÖ Filtered results:",G.length),G},[b,m]),oe=N=>{var Z,K;L.find(ae=>ae.partId===N.id)?P(ae=>ae.map(ne=>ne.partId===N.id?{...ne,quantity:ne.quantity+1}:ne)):(P([...L,{partId:N.id,partName:N.name,sku:N.sku,quantity:1,importPrice:((Z=N.costPrice)==null?void 0:Z[i])||0,sellingPrice:N.retailPrice[i]||0,wholesalePrice:((K=N.wholesalePrice)==null?void 0:K[i])||0}]),q.success(`ƒê√£ th√™m ${N.name} v√†o phi·∫øu nh·∫≠p`)),x(""),setTimeout(()=>{var ae;return(ae=t.current)==null?void 0:ae.focus()},100)},Ce=N=>{if(N.preventDefault(),!h.trim())return;const G=h.trim(),Z=ne=>ne.toLowerCase().replace(/[-\s./\\]/g,""),K=Z(G),ae=b.find(ne=>{var ge,pe,ve;return Z(ne.barcode||"")===K||((ge=ne.barcode)==null?void 0:ge.toLowerCase())===G.toLowerCase()||Z(ne.sku||"")===K||((pe=ne.sku)==null?void 0:pe.toLowerCase())===G.toLowerCase()||((ve=ne.name)==null?void 0:ve.toLowerCase().includes(G.toLowerCase()))});ae?(oe(ae),l("")):(q.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m c√≥ m√£: ${G}`),l(""))},Me=N=>{console.log("üì∑ Camera scanned:",N);const G=ae=>ae.toLowerCase().replace(/[-\s./\\]/g,""),Z=G(N),K=b.find(ae=>{var ne,ge;return G(ae.barcode||"")===Z||((ne=ae.barcode)==null?void 0:ne.toLowerCase())===N.toLowerCase()||G(ae.sku||"")===Z||((ge=ae.sku)==null?void 0:ge.toLowerCase())===N.toLowerCase()});K?(L.find(ne=>ne.partId===K.id)?P(ne=>ne.map(ge=>ge.partId===K.id?{...ge,quantity:ge.quantity+1}:ge)):(P(ne=>{var ge,pe;return[...ne,{partId:K.id,partName:K.name,sku:K.sku,quantity:1,importPrice:((ge=K.costPrice)==null?void 0:ge[i])||0,sellingPrice:K.retailPrice[i]||0,wholesalePrice:((pe=K.wholesalePrice)==null?void 0:pe[i])||0}]}),q.success(`ƒê√£ th√™m ${K.name}`)),x("")):q.error(`Kh√¥ng t√¨m th·∫•y: ${N}`)};y.useEffect(()=>{a&&setTimeout(()=>{var N;return(N=t.current)==null?void 0:N.focus()},100)},[a]);const ie=(N,G,Z)=>{P(K=>K.map(ae=>ae.partId===N?{...ae,[G]:Z}:ae))},Fe=N=>{P(G=>G.filter(Z=>Z.partId!==N))},R=y.useMemo(()=>L.reduce((N,G)=>N+G.importPrice*G.quantity,0),[L]),re=y.useMemo(()=>Math.max(0,R-de),[R,de]),{profile:J}=Aa(),se=()=>{var G;if(!is(J==null?void 0:J.role,"part.update_price")){q.error("B·∫°n kh√¥ng c√≥ quy·ªÅn c·∫≠p nh·∫≠t gi√°");return}if(L.length===0){q.warning("Vui l√≤ng ch·ªçn s·∫£n ph·∫©m nh·∫≠p kho");return}(G=v.find(Z=>Z.id===o))!=null&&G.name,c(L,o,re,"",{paymentMethod:D||"cash",paymentType:z||"full",paidAmount:z==="full"?re:z==="partial"?te:0,discount:de}),A(),P([]),u(""),x(""),Y(0),T(0),U("amount")},be=N=>{(async()=>{var G,Z;try{const K=((G=N.barcode)==null?void 0:G.trim())||`PT-${Date.now()}`,ae=await _.mutateAsync({name:N.name,sku:K,barcode:((Z=N.barcode)==null?void 0:Z.trim())||"",category:N.category,description:N.description,stock:{[i]:0},costPrice:{[i]:N.importPrice},retailPrice:{[i]:N.retailPrice},wholesalePrice:{[i]:Math.round(N.retailPrice*.9)}}),ne=(ae==null?void 0:ae.data)||ae,ge=(ne==null?void 0:ne.id)||`temp-${Date.now()}-${Math.random().toString(36).slice(2)}`,pe=(ne==null?void 0:ne.sku)||K;P(ve=>[...ve,{partId:ge,partName:N.name,sku:pe,quantity:N.quantity,importPrice:N.importPrice,sellingPrice:N.retailPrice,wholesalePrice:N.wholesalePrice||0}]),q.success("ƒê√£ t·∫°o ph·ª• t√πng m·ªõi v√† th√™m v√†o phi·∫øu nh·∫≠p")}catch(K){q.error((K==null?void 0:K.message)||"L·ªói t·∫°o ph·ª• t√πng m·ªõi")}finally{M(!1)}})()};return d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 w-full max-w-7xl h-[92vh] rounded-2xl shadow-2xl overflow-hidden flex",children:[e.jsxs("div",{className:"w-1/2 flex flex-col bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-r border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/50 dark:border-slate-700/50 bg-gradient-to-r from-blue-50/50 to-indigo-50/50 dark:from-slate-800/50 dark:to-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:f,className:"w-9 h-9 flex items-center justify-center hover:bg-white/80 dark:hover:bg-slate-700/80 rounded-lg text-slate-600 dark:text-slate-400 transition-all hover:scale-105",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:"Danh m·ª•c s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Ch·ªçn ƒë·ªÉ th√™m v√†o gi·ªè"})]})]}),e.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-3 py-2 rounded-lg text-xs font-semibold shadow-lg shadow-blue-500/30 transition-all hover:scale-105",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Th√™m m·ªõi"})]})]}),e.jsxs("div",{className:"p-3 bg-white/50 dark:bg-slate-800/50 space-y-2",children:[a&&e.jsx("form",{onSubmit:Ce,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),e.jsx("input",{ref:t,type:"text",placeholder:"Qu√©t m√£ v·∫°ch ho·∫∑c nh·∫≠p SKU...",value:h,onChange:N=>l(N.target.value),className:"w-full pl-10 pr-8 py-2.5 border-2 border-blue-300 dark:border-blue-600 rounded-xl bg-blue-50/50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 text-sm placeholder:text-blue-500/60 dark:placeholder:text-blue-400/60 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all font-mono"}),h&&e.jsx("button",{type:"button",onClick:()=>l(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("button",{type:"button",onClick:()=>{n(!1),l("")},className:"px-3 py-2.5 rounded-xl border-2 border-slate-300 dark:border-slate-600 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",title:"ƒê√≥ng",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Ho·∫∑c t√¨m ki·∫øm th·ªß c√¥ng...",value:m,onChange:N=>x(N.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm placeholder:text-slate-400 focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all"})]}),!a&&e.jsx("button",{type:"button",onClick:()=>{n(!0),setTimeout(()=>{var N;return(N=t.current)==null?void 0:N.focus()},100)},className:"px-3 py-2.5 rounded-xl border-2 border-blue-400 text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-600 dark:text-blue-400 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-blue-100 dark:hover:bg-blue-900/40",title:"Qu√©t m√£ v·∫°ch",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"px-3 py-2.5 rounded-xl border-2 border-green-500 text-green-600 bg-green-50 dark:bg-green-900/20 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-green-100",title:"Qu√©t b·∫±ng camera",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:Q.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[e.jsx("svg",{className:"w-16 h-16 mb-3 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{className:"text-sm font-medium",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-xs mt-1",children:"Th·ª≠ t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a kh√°c"})]}):e.jsx("div",{className:"space-y-2",children:Q.map(N=>e.jsx("div",{onClick:()=>oe(N),className:"group p-3 bg-white dark:bg-slate-800 rounded-xl hover:shadow-lg hover:shadow-blue-500/10 cursor-pointer border border-slate-200 dark:border-slate-700 hover:border-blue-400 dark:hover:border-blue-600 transition-all duration-200 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 line-clamp-1 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:N.name}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-mono bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded",children:N.sku}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[9px] font-medium ${N.category?`${je(N.category).bg} ${je(N.category).text}`:"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}`,children:N.category||"Ch∆∞a ph√¢n lo·∫°i"})]})]}),e.jsx("svg",{className:"w-5 h-5 text-slate-300 dark:text-slate-600 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},N.id))})})]}),e.jsxs("div",{className:"w-1/2 bg-white dark:bg-slate-800 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-emerald-50/30 to-teal-50/30 dark:from-slate-800/50 dark:to-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Nh√† cung c·∫•p"}),e.jsxs("button",{onClick:()=>{C({name:"",phone:"",address:"",note:""}),B(!0)},className:"ml-auto flex items-center gap-1 text-xs px-2 py-1 rounded-lg bg-emerald-100 text-emerald-700 hover:bg-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:hover:bg-emerald-900/50 font-medium transition-all",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Th√™m NCC"]})]}),e.jsxs("select",{value:o,onChange:N=>u(N.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm font-medium focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-all",children:[e.jsx("option",{value:"",children:"Ch·ªçn nh√† cung c·∫•p..."}),v.map(N=>e.jsxs("option",{value:N.id,children:[N.name," ",N.phone?`‚Ä¢ ${N.phone}`:""]},N.id))]})]}),O&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:"Th√™m nh√† cung c·∫•p"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"T√™n *"}),e.jsx("input",{autoFocus:!0,value:w.name,onChange:N=>C(G=>({...G,name:N.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm",placeholder:"T√™n nh√† cung c·∫•p"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"ƒêi·ªán tho·∫°i"}),e.jsx("input",{value:w.phone,onChange:N=>C(G=>({...G,phone:N.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm",placeholder:"SƒêT"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{rows:2,value:w.address,onChange:N=>C(G=>({...G,address:N.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm resize-none",placeholder:"ƒê·ªãa ch·ªâ nh√† cung c·∫•p"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"Ghi ch√∫"}),e.jsx("textarea",{rows:2,value:w.note,onChange:N=>C(G=>({...G,note:N.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm resize-none",placeholder:"Th√¥ng tin th√™m (t√πy ch·ªçn)"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 text-sm rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{onClick:async()=>{var N,G;if(!w.name.trim()){q.warning("Nh·∫≠p t√™n nh√† cung c·∫•p");return}try{const Z=await E.mutateAsync({name:w.name.trim(),phone:((N=w.phone)==null?void 0:N.trim())||void 0,address:((G=w.address)==null?void 0:G.trim())||void 0});u(Z.id),B(!1)}catch{}},className:"px-4 py-2 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:E.isPending,children:E.isPending?"ƒêang l∆∞u...":"L∆∞u"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:"Gi·ªè h√†ng nh·∫≠p"})]}),e.jsxs("span",{className:"text-xs text-white bg-gradient-to-r from-blue-600 to-indigo-600 px-3 py-1 rounded-full font-semibold shadow-lg",children:[L.length," s·∫£n ph·∫©m"]})]}),L.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-700 rounded-2xl flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-slate-300 dark:text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("p",{className:"text-sm font-semibold text-slate-500 dark:text-slate-400",children:"Gi·ªè h√†ng tr·ªëng"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ch·ªçn s·∫£n ph·∫©m b√™n tr√°i ƒë·ªÉ th√™m v√†o"})]}):e.jsx("div",{className:"space-y-2",children:L.map((N,G)=>{const Z=b.find(K=>K.id===N.partId);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-2.5 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:e.jsxs("span",{className:"text-[10px] font-bold text-white",children:["#",G+1]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-xs text-slate-900 dark:text-slate-100 truncate",children:N.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[9px] text-blue-600 dark:text-blue-400 font-mono",children:N.sku}),(Z==null?void 0:Z.category)&&e.jsx("span",{className:`inline-flex items-center px-1 py-0 rounded text-[8px] font-medium ${je(Z.category).bg} ${je(Z.category).text}`,children:Z.category})]})]}),e.jsx("button",{onClick:()=>Fe(N.partId),className:"w-5 h-5 flex items-center justify-center bg-red-100 dark:bg-red-900/30 rounded text-red-600 dark:text-red-400 hover:bg-red-200 flex-shrink-0 text-sm",title:"X√≥a",children:"√ó"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>ie(N.partId,"quantity",Math.max(1,N.quantity-1)),className:"w-6 h-6 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300 hover:bg-blue-50 text-sm",children:"-"}),e.jsx("input",{type:"number",value:N.quantity,onChange:K=>{const ae=parseInt(K.target.value)||1;ie(N.partId,"quantity",Math.max(1,ae))},className:"w-10 px-1 py-1 text-center border border-blue-300 dark:border-blue-700 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs font-semibold",min:"1"}),e.jsx("button",{onClick:()=>ie(N.partId,"quantity",N.quantity+1),className:"w-6 h-6 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300 hover:bg-blue-50 text-sm",children:"+"})]}),e.jsx(qe,{value:N.importPrice,onValue:K=>{const{clean:ae}=br(K,N.quantity),ne=ae.importPrice,ge=Math.round(ne*1.5);P(pe=>pe.map(ve=>ve.partId===N.partId?{...ve,importPrice:ne,sellingPrice:ve.sellingPrice===0||ve.sellingPrice===Math.round((ve.importPrice||0)*1.5)?ge:ve.sellingPrice}:ve))},className:"min-w-[70px] max-w-[110px] flex-1 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-xs font-medium focus:border-blue-500",placeholder:"Gi√° nh·∫≠p"}),e.jsx(qe,{value:N.sellingPrice,onValue:K=>ie(N.partId,"sellingPrice",Math.max(0,Math.round(K))),className:"min-w-[70px] max-w-[110px] flex-1 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-xs font-medium focus:border-emerald-500",placeholder:"Gi√° b√°n"}),e.jsx("div",{className:"min-w-[70px] text-right flex-shrink-0",children:e.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 whitespace-nowrap",children:W(N.importPrice*N.quantity)})})]})]},N.partId)})})]}),e.jsxs("div",{className:"p-3 border-t-2 border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800",children:[e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-white uppercase",children:"T·ªïng thanh to√°n"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-black text-white",children:W(re)}),e.jsxs("div",{className:"text-[10px] text-white/70",children:[L.length," SP"]})]})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:["Ph∆∞∆°ng th·ª©c thanh to√°n ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>$("cash"),className:`flex items-center justify-center gap-1.5 px-3 py-2 border-2 rounded-lg text-xs font-bold transition-all ${D==="cash"?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"üíµ Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>$("bank"),className:`flex items-center justify-center gap-1.5 px-3 py-2 border-2 rounded-lg text-xs font-bold transition-all ${D==="bank"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"üè¶ Chuy·ªÉn kho·∫£n"})]})]}),D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"H√¨nh th·ª©c thanh to√°n"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx("button",{onClick:()=>{H("full"),ce(0)},className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="full"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>H("partial"),className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="partial"?"border-orange-500 bg-orange-50 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"1 ph·∫ßn"}),e.jsx("button",{onClick:()=>{H("note"),ce(0)},className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="note"?"border-purple-500 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"C√¥ng n·ª£"})]})]}),z==="partial"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"S·ªë ti·ªÅn kh√°ch tr·∫£"}),e.jsx(qe,{value:te,onValue:N=>ce(Math.max(0,Math.round(N))),className:"w-full px-3 py-2 border-2 border-orange-300 dark:border-orange-700 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-sm font-bold focus:border-orange-500",placeholder:"Nh·∫≠p s·ªë ti·ªÅn..."}),e.jsxs("div",{className:"mt-1.5 flex items-center justify-between text-[10px]",children:[e.jsx("span",{className:"text-slate-500",children:"C√≤n l·∫°i:"}),e.jsx("span",{className:"font-bold text-red-600 dark:text-red-400",children:W(Math.max(0,re-te))})]})]}),z&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"Lo·∫°i h·∫°ch to√°n"}),e.jsxs("select",{className:"w-full px-3 py-2 border-2 border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs font-semibold focus:border-blue-500",children:[e.jsx("option",{children:"Mua h√†ng/nh·∫≠p kho"}),e.jsx("option",{children:"Nh·∫≠p tr·∫£ h√†ng"}),e.jsx("option",{children:"Kh√°c"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"flex-1 bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 px-3 py-2.5 rounded-lg font-bold text-xs transition-all",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"L∆ØU NH√ÅP"]})}),e.jsx("button",{onClick:()=>{if(!D){q.warning("Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n");return}if(!z){q.warning("Vui l√≤ng ch·ªçn h√¨nh th·ª©c thanh to√°n");return}if(z==="partial"&&te<=0){q.warning("Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn kh√°ch tr·∫£");return}se()},disabled:!D||!z||z==="partial"&&te<=0,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white px-3 py-2.5 rounded-lg font-bold text-xs transition-all disabled:bg-slate-300 disabled:text-slate-500 disabled:cursor-not-allowed dark:disabled:bg-slate-600 dark:disabled:text-slate-400",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),"NH·∫¨P KHO"]})})]})]})]})]})}),e.jsx(Ra,{isOpen:r,onClose:()=>s(!1),onScan:Me}),e.jsx(Xa,{isOpen:S,onClose:()=>M(!1),onSave:be})]}):null},wn=({isOpen:d,onClose:f,onSave:b,initialData:i,mode:c})=>{const[m,x]=y.useState((i==null?void 0:i.name)||""),[h,l]=y.useState((i==null?void 0:i.phone)||""),[t,r]=y.useState((i==null?void 0:i.address)||""),[s,a]=y.useState((i==null?void 0:i.email)||"");y.useEffect(()=>{i&&(x(i.name),l(i.phone),r(i.address),a(i.email))},[i]);const n=o=>{if(o.preventDefault(),!m.trim()){q.error("Vui l√≤ng nh·∫≠p t√™n nh√† cung c·∫•p");return}b({name:m.trim(),phone:h.trim(),address:t.trim(),email:s.trim()})};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-md",children:e.jsxs("form",{onSubmit:n,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:c==="add"?"Th√™m nh√† cung c·∫•p m·ªõi":"Ch·ªânh s·ª≠a nh√† cung c·∫•p"}),e.jsx("button",{type:"button",onClick:f,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T√™n nh√† cung c·∫•p *"}),e.jsx("input",{type:"text",value:m,onChange:o=>x(o.target.value),placeholder:"Nh·∫≠p t√™n nh√† cung c·∫•p",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"S·ªë ƒëi·ªán tho·∫°i"}),e.jsx("input",{type:"tel",value:h,onChange:o=>l(o.target.value),placeholder:"Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s,onChange:o=>a(o.target.value),placeholder:"Nh·∫≠p email",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{value:t,onChange:o=>r(o.target.value),placeholder:"Nh·∫≠p ƒë·ªãa ch·ªâ",rows:3,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:c==="add"?"Th√™m":"L∆∞u"})]})]})})}):null},Nn=({isOpen:d,onClose:f,onAdd:b,currentBranchId:i})=>{const[c,m]=y.useState(""),[x,h]=y.useState(null),[l,t]=y.useState(1),[r,s]=y.useState(0),{data:a=[]}=xt({queryKey:["allPartsForReceipt"],queryFn:async()=>{const{data:g,error:k}=await he.from("parts").select("*").order("name");if(k)throw k;return g||[]}}),n=y.useMemo(()=>{if(!c)return[];const g=c.toLowerCase();return a.filter(k=>{var v,E;return k.name.toLowerCase().includes(g)||((v=k.sku)==null?void 0:v.toLowerCase().includes(g))||((E=k.description)==null?void 0:E.toLowerCase().includes(g))})},[a,c]),o=g=>{var k;h(g),s(((k=g.costPrice)==null?void 0:k[i])||0),m(g.name)},u=g=>{if(g.preventDefault(),!x){q.error("Vui l√≤ng ch·ªçn s·∫£n ph·∫©m");return}if(l<=0){q.error("S·ªë l∆∞·ª£ng ph·∫£i l·ªõn h∆°n 0");return}if(r<0){q.error("ƒê∆°n gi√° kh√¥ng ƒë∆∞·ª£c √¢m");return}b({partId:x.id,partName:x.name,sku:x.sku||"",quantity:l,unitPrice:r}),m(""),h(null),t(1),s(0)};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-lg",children:e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Th√™m s·∫£n ph·∫©m v√†o phi·∫øu"}),e.jsx("button",{type:"button",onClick:f,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T√¨m ki·∫øm s·∫£n ph·∫©m *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:c,onChange:g=>{m(g.target.value),h(null)},placeholder:"Nh·∫≠p t√™n ho·∫∑c SKU s·∫£n ph·∫©m...",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",autoFocus:!0}),c&&!x&&n.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:n.map(g=>{var k;return e.jsxs("button",{type:"button",onClick:()=>o(g),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-700 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:g.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",g.sku||"N/A"," | Gi√° nh·∫≠p:"," ",W(((k=g.costPrice)==null?void 0:k[i])||0)]})]},g.id)})})]}),x&&e.jsxs("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded text-sm text-green-800 dark:text-green-200",children:["‚úì ƒê√£ ch·ªçn: ",x.name," (",x.sku,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"S·ªë l∆∞·ª£ng *"}),e.jsx("input",{type:"number",value:l,onChange:g=>t(Number(g.target.value)),min:"1",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê∆°n gi√° nh·∫≠p *"}),e.jsx(qe,{value:r,onValue:s,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Th√†nh ti·ªÅn"}),e.jsx("input",{type:"text",value:W(l*r),readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100 font-bold"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:"Th√™m s·∫£n ph·∫©m"})]})]})})}):null},_n=({receipt:d,onClose:f,onSave:b,currentBranchId:i})=>{const[c,m]=y.useState(d.supplier),[x,h]=y.useState(""),[l,t]=y.useState(d.supplier),[r,s]=y.useState(!1),[a,n]=y.useState(!1),[o,u]=y.useState("add"),[g,k]=y.useState(!1),[v,E]=y.useState(null),{data:O=[]}=xt({queryKey:["suppliers"],queryFn:async()=>{const{data:T,error:p}=await he.from("suppliers").select("*").order("name");if(p)throw p;return T||[]}}),B=y.useMemo(()=>{if(!l)return O;const T=l.toLowerCase();return O.filter(p=>p.name.toLowerCase().includes(T))},[O,l]),[w,C]=y.useState(d.items.map(T=>({id:T.id,partName:T.partName,quantity:T.quantity,unitPrice:T.unitPrice||0,totalPrice:T.quantity*(T.unitPrice||0),notes:T.notes||""}))),[_,S]=y.useState([{time:"15:31",date:d.date,payer:"Xu√¢n Nhan",cashier:"(Ti·ªÅn m·∫∑t)",amount:d.total}]),[M,L]=y.useState(!0);ht.useEffect(()=>{var p,A,Q;const T=d.items[0];if((p=T==null?void 0:T.notes)!=null&&p.includes("Phone:")){const oe=(Q=(A=T.notes.split("Phone:")[1])==null?void 0:A.split("NV:")[0])==null?void 0:Q.trim();oe&&h(oe)}},[d.items]),ht.useEffect(()=>{const T=p=>{p.target.closest(".supplier-dropdown-container")||s(!1)};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const P=w.reduce((T,p)=>T+p.totalPrice,0),D=_.reduce((T,p)=>T+p.amount,0),$=(T,p)=>{const A=[...w];A[T].quantity=p,A[T].totalPrice=p*A[T].unitPrice,C(A)},z=(T,p)=>{const A=[...w];A[T].unitPrice=p,A[T].totalPrice=A[T].quantity*p,C(A)},H=T=>{if(w.length===1){q.error("Ph·∫£i c√≥ √≠t nh·∫•t 1 s·∫£n ph·∫©m");return}const p=w.filter((A,Q)=>Q!==T);C(p),q.success("ƒê√£ x√≥a s·∫£n ph·∫©m")},te=T=>{const p={id:`new-${Date.now()}`,partId:T.partId,partName:T.partName,quantity:T.quantity,unitPrice:T.unitPrice,totalPrice:T.quantity*T.unitPrice,notes:"",sku:T.sku};C([...w,p]),k(!1),q.success(`ƒê√£ th√™m ${T.partName} (s·∫Ω l∆∞u khi b·∫•m L∆ØU)`)},ce=T=>{m(T.name),h(T.phone),n(!1),q.success(o==="add"?"ƒê√£ th√™m nh√† cung c·∫•p":"ƒê√£ c·∫≠p nh·∫≠t nh√† cung c·∫•p")},de=()=>{u("edit"),n(!0)},Y=()=>{u("add"),n(!0)},ee=T=>{E(T),q.info("Click v√†o √¥ s·ªë l∆∞·ª£ng ho·∫∑c ƒë∆°n gi√° ƒë·ªÉ ch·ªânh s·ª≠a")},U=T=>{confirm("B·∫°n c√≥ mu·ªën x√≥a s·∫£n ph·∫©m n√†y?")&&H(T)},ue=T=>{if(T.preventDefault(),!c){q.error("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}if(w.some(p=>p.quantity<=0)){q.error("S·ªë l∆∞·ª£ng ph·∫£i l·ªõn h∆°n 0");return}b({supplier:c,supplierPhone:x,items:w,payments:_,isPaid:M})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("form",{onSubmit:ue,children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["[Ch·ªânh s·ª≠a] Phi·∫øu Nh·∫≠p Kho ",d.receiptCode]})]}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:[new Date(d.date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})," ",new Date(d.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("button",{type:"button",onClick:f,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl w-8 h-8 flex items-center justify-center rounded hover:bg-slate-100 dark:hover:bg-slate-700",children:"√ó"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400 mb-2",children:"Nh√† cung c·∫•p:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative supplier-dropdown-container",children:[e.jsx("input",{type:"text",value:l,onChange:T=>{t(T.target.value),s(!0)},onFocus:()=>s(!0),placeholder:"T√¨m ki·∫øm v√† ch·ªçn m·ªôt nh√† cung c·∫•p",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),l&&e.jsx("button",{type:"button",onClick:()=>{t(""),m(""),h("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:"√ó"}),r&&B.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:B.map(T=>e.jsxs("button",{type:"button",onClick:()=>{m(T.name),t(T.name),h(T.phone||""),s(!1)},className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-700 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:T.name}),T.phone&&e.jsxs("div",{className:"text-xs text-slate-500",children:["Phone: ",T.phone]})]},T.id))})]}),e.jsxs("button",{type:"button",onClick:de,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Ch·ªânh s·ª≠a"]}),e.jsxs("button",{type:"button",onClick:Y,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"+"}),"Th√™m m·ªõi"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400",children:"Chi ti·∫øt s·∫£n ph·∫©m nh·∫≠p kho:"}),e.jsxs("button",{type:"button",onClick:()=>k(!0),className:"text-sm text-teal-600 hover:text-teal-700 dark:text-teal-400 flex items-center gap-1",children:[e.jsx("span",{className:"text-lg",children:"+"}),"Th√™m s·∫£n ph·∫©m"]})]}),e.jsx("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-slate-700 dark:text-slate-300",children:"-"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-slate-700 dark:text-slate-300",children:"T√™n"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-medium text-slate-700 dark:text-slate-300",children:"SL"}),e.jsx("th",{className:"px-3 py-2 text-right text-sm font-medium text-slate-700 dark:text-slate-300",children:"ƒê∆°n gi√° nh·∫≠p"}),e.jsx("th",{className:"px-3 py-2 text-right text-sm font-medium text-slate-700 dark:text-slate-300",children:"Th√†nh ti·ªÅn"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-medium text-slate-700 dark:text-slate-300 w-20"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:w.map((T,p)=>e.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors ${v===p?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx("td",{className:"px-3 py-3 text-sm text-slate-900 dark:text-slate-100",children:p+1}),e.jsxs("td",{className:"px-3 py-3",children:[e.jsx("div",{className:"text-sm text-slate-900 dark:text-slate-100",children:T.partName}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"[Kh√°c]"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["- ƒêG B√°n l·∫ª: ",W(7e4)]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["- ƒêG B√°n s·ªâ: ",W(0)]}),e.jsx("div",{className:"text-xs text-red-500",children:"(ƒê√£ xu·∫•t kho)"})]}),e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsx("input",{type:"number",value:T.quantity,onChange:A=>$(p,Number(A.target.value)),onFocus:()=>E(p),onBlur:()=>E(null),min:"1",className:"w-16 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-center bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-3 text-right",children:e.jsx(qe,{value:T.unitPrice,onValue:A=>z(p,A),className:"w-28 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-right bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-3 text-right text-sm font-medium text-slate-900 dark:text-slate-100",children:W(T.totalPrice)}),e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>ee(p),className:"p-1 text-blue-400 hover:bg-blue-500/20 rounded",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{type:"button",onClick:()=>U(p),className:"p-1 text-slate-400 hover:bg-slate-500/20 rounded",title:"X√≥a s·∫£n ph·∫©m",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]})})]},T.id))}),e.jsx("tfoot",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-3 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:"T·ªîNG:"}),e.jsx("td",{className:"px-3 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:W(P)}),e.jsx("td",{})]})})]})})]}),e.jsxs("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg p-4",children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400 mb-3",children:"C√¥ng n·ª£:"}),e.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsxs("span",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:["T·ªîNG PH·∫¢I CHI: ",W(P)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"ƒê√£ thanh to√°n ƒë·ªß"]}),e.jsxs("button",{type:"button",className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm flex items-center gap-1",children:[e.jsx("span",{className:"text-lg",children:"+"}),"T·∫°o phi·∫øu chi"]})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3 flex items-start gap-1",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"T·ªïng ph·∫£i chi l√† ph√≠ ch∆∞a ph·∫£i tr·∫£ cho ƒë·ªëi t√°c s·ª≠a ch·ªØa"]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"-"}),e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"Th·ªùi gian"}),e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"Ng∆∞·ªùi chi - Ghi ch√∫"}),e.jsx("th",{className:"px-2 py-2 text-right text-slate-700 dark:text-slate-300",children:"S·ªë ti·ªÅn"})]})}),e.jsx("tbody",{children:_.map((T,p)=>e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e.jsx("td",{className:"px-2 py-2 text-slate-900 dark:text-slate-100",children:p+1}),e.jsxs("td",{className:"px-2 py-2 text-slate-900 dark:text-slate-100",children:[T.time," ",new Date(T.date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})]}),e.jsxs("td",{className:"px-2 py-2",children:[e.jsx("div",{className:"text-slate-900 dark:text-slate-100",children:T.payer}),e.jsx("div",{className:"text-xs text-slate-500",children:T.cashier})]}),e.jsx("td",{className:"px-2 py-2 text-right text-slate-900 dark:text-slate-100",children:W(T.amount)})]},p))}),e.jsx("tfoot",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-2 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:"T·ªïng ƒë√£ chi"}),e.jsx("td",{className:"px-2 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:W(D)})]})})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 p-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:f,className:"px-6 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"ƒê√ìNG"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:"L∆ØU"})]})]}),e.jsx(wn,{isOpen:a,onClose:()=>n(!1),onSave:ce,initialData:o==="edit"?{name:c,phone:x,address:"",email:""}:void 0,mode:o}),e.jsx(Nn,{isOpen:g,onClose:()=>k(!1),onAdd:te,currentBranchId:i})]})})},Sn=({transactions:d})=>{const f=pr(),{data:b=[]}=Da(),[i,c]=y.useState("7days"),[m,x]=y.useState(tt(new Date,!0)),[h,l]=y.useState(tt(new Date,!0)),[t,r]=y.useState(""),[s,a]=y.useState(null),{currentBranchId:n}=ar(),o=y.useMemo(()=>{console.log("üì¶ [InventoryHistorySection] T·ªïng s·ªë giao d·ªãch:",d.length);let w=d.filter(_=>_.type==="Nh·∫≠p kho");console.log("üì¶ [InventoryHistorySection] Giao d·ªãch 'Nh·∫≠p kho':",w.length);const C=new Date;switch(i){case"7days":const _=new Date(C.getTime()-6048e5);w=w.filter(L=>new Date(L.date)>=_);break;case"30days":const S=new Date(C.getTime()-720*60*60*1e3);w=w.filter(L=>new Date(L.date)>=S);break;case"thisMonth":const M=new Date(C.getFullYear(),C.getMonth(),1);w=w.filter(L=>new Date(L.date)>=M);break;case"custom":w=w.filter(L=>{const P=new Date(L.date);return P>=new Date(m)&&P<=new Date(h)});break}if(t){const _=t.toLowerCase();w=w.filter(S=>S.partName.toLowerCase().includes(_)||S.notes&&S.notes.toLowerCase().includes(_))}return w.sort((_,S)=>new Date(S.date).getTime()-new Date(_.date).getTime())},[d,i,m,h,t]),u=y.useMemo(()=>o.reduce((w,C)=>w+C.totalPrice,0),[o]),g=y.useMemo(()=>{const w=new Map;return o.forEach(C=>{var P,D;const _=new Date(C.date),S=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}-${String(_.getDate()).padStart(2,"0")}`,M=(P=C.notes)!=null&&P.includes("NCC:")?(D=C.notes.split("NCC:")[1])==null?void 0:D.trim():"Kh√¥ng x√°c ƒë·ªãnh",L=`${S}_${M}_${_.getHours()}_${_.getMinutes()}`;w.has(L)||w.set(L,[]),w.get(L).push(C)}),Array.from(w.entries()).map(([C,_],S)=>{var D,$,z;const M=_[0],L=new Date(M.date);let P="";if(M.notes){const H=M.notes.match(/NH-\d{8}-\d{3}/);H&&(P=H[0])}return P||(P=`NH-${`${L.getFullYear()}${String(L.getMonth()+1).padStart(2,"0")}${String(L.getDate()).padStart(2,"0")}`}-${String(w.size-S).padStart(3,"0")}`),{receiptCode:P,date:M.date,supplier:(D=M.notes)!=null&&D.includes("NCC:")?(z=($=M.notes.split("NCC:")[1])==null?void 0:$.split("|")[0])==null?void 0:z.trim():"Kh√¥ng x√°c ƒë·ªãnh",items:_,total:_.reduce((H,te)=>H+te.totalPrice,0)}}).sort((C,_)=>new Date(_.date).getTime()-new Date(C.date).getTime())},[o]),[k,v]=y.useState(new Set),[E,O]=y.useState(new Set),B=w=>{O(C=>{const _=new Set(C);return _.has(w)?_.delete(w):_.add(w),_})};return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-3 sm:p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100 mb-3 sm:mb-4",children:"L·ªãch s·ª≠ nh·∫≠p kho"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 sm:mb-4",children:[{key:"7days",label:"7 ng√†y qua"},{key:"30days",label:"30 ng√†y qua"},{key:"thisMonth",label:"Th√°ng n√†y"},{key:"custom",label:"T√πy ch·ªçn"}].map(w=>e.jsx("button",{onClick:()=>c(w.key),className:`px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base font-medium transition-colors ${i===w.key?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:w.label},w.key))}),i==="custom"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ª´ ng√†y"}),e.jsx("input",{type:"date",value:m,onChange:w=>x(w.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·∫øn ng√†y"}),e.jsx("input",{type:"date",value:h,onChange:w=>l(w.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]})]}),e.jsx("input",{type:"text",placeholder:"Nh√† cung c·∫•p, SKU, t√™n ph·ª• t√πng...",value:t,onChange:w=>r(w.target.value),className:"w-full px-3 py-2 sm:px-4 sm:py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]}),e.jsx("div",{className:"px-3 py-3 sm:px-6 sm:py-4 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:["T·ªïng s·ªë phi·∫øu:"," ",e.jsx("span",{className:"text-base sm:text-lg font-bold text-slate-900 dark:text-slate-100",children:g.length})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng gi√° tr·ªã"}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-blue-600",children:W(u)})]})]})}),e.jsxs("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[g.length>0&&e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 px-4 py-3 bg-slate-100 dark:bg-slate-700 border-b border-slate-200 dark:border-slate-600 sticky top-0 z-10",children:[e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Nh√† cung c·∫•p"}),e.jsx("div",{className:"col-span-4 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Chi ti·∫øt"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thanh to√°n"}),e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thao t√°c"})]}),g.length===0?e.jsxs("div",{className:"px-3 py-8 sm:px-6 sm:py-12 text-center text-slate-500",children:[e.jsx("div",{className:"text-4xl sm:text-6xl mb-4",children:"üì¶"}),e.jsx("div",{className:"text-sm sm:text-base",children:"Kh√¥ng c√≥ d·ªØ li·ªáu"})]}):g.map(w=>{var $,z,H,te,ce,de,Y;const C=new Date(w.date),_=C.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),S=C.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),M=b.find(ee=>{var U;return(U=ee.description)==null?void 0:U.includes(w.receiptCode)}),L=M?M.totalAmount-M.remainingAmount:w.total,P=(M==null?void 0:M.remainingAmount)||0,D=P>0;return e.jsxs("div",{className:"p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden flex flex-col gap-3 bg-white dark:bg-slate-800/60 rounded-2xl border border-slate-200 dark:border-slate-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-cyan-600 dark:text-cyan-300",children:["üì¶ ",w.receiptCode]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:["üìÖ"," ",e.jsxs("span",{children:[_," ¬∑ ",S]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:W(w.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 dark:bg-slate-900/30 rounded-2xl p-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-200 font-semibold text-lg",children:"üè¢"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-white",children:w.supplier}),(($=w.items[0].notes)==null?void 0:$.includes("Phone:"))&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",(z=w.items[0].notes.split("Phone:")[1])==null?void 0:z.trim()]})]})]}),e.jsx("div",{className:"space-y-2",children:(()=>{const ee=E.has(w.receiptCode),U=3,ue=ee?w.items:w.items.slice(0,U),T=w.items.length>U;return e.jsxs(e.Fragment,{children:[ue.map((p,A)=>e.jsxs("div",{className:"flex items-start justify-between text-sm text-slate-700 dark:text-slate-200",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold",children:[p.quantity," x ",p.partName]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[W(p.unitPrice||0)," / s·∫£n ph·∫©m"]})]}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:W(p.quantity*(p.unitPrice||0))})]},p.id)),T&&e.jsx("button",{onClick:()=>B(w.receiptCode),className:"w-full text-sm text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 font-medium py-2 flex items-center justify-center gap-1 bg-slate-50 dark:bg-slate-900/50 rounded-lg",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Thu g·ªçn"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Xem th√™m (",w.items.length-U," ","s·∫£n ph·∫©m)"]})})]})})()}),e.jsx("div",{className:"flex flex-wrap gap-2",children:D?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",W(P)]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-200",children:"‚úì ƒê√£ thanh to√°n"})}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-dashed border-slate-200 dark:border-slate-700",children:e.jsx("button",{onClick:()=>a({...w,date:new Date(w.date)}),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Ch·ªânh s·ª≠a"})})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-1 flex items-start pt-1",children:e.jsx("input",{type:"checkbox",checked:k.has(w.receiptCode),onChange:ee=>{const U=new Set(k);ee.target.checked?U.add(w.receiptCode):U.delete(w.receiptCode),v(U)},className:"w-4 h-4 rounded border-slate-300"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-bold text-cyan-600 dark:text-cyan-400",children:w.receiptCode}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[_," ",S]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"NV:"})," ",((ce=(te=(H=w.items[0].notes)==null?void 0:H.split("NV:")[1])==null?void 0:te.split("NCC:")[0])==null?void 0:ce.trim())||"Xu√¢n Nhan"]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:w.supplier}),((de=w.items[0].notes)==null?void 0:de.includes("Phone:"))&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",(Y=w.items[0].notes.split("Phone:")[1])==null?void 0:Y.trim()]})]})}),e.jsx("div",{className:"col-span-4",children:e.jsx("div",{className:"space-y-1",children:(()=>{const ee=E.has(w.receiptCode),U=3,ue=ee?w.items:w.items.slice(0,U),T=w.items.length>U;return e.jsxs(e.Fragment,{children:[ue.map((p,A)=>e.jsxs("div",{className:"text-xs text-slate-700 dark:text-slate-300",children:[e.jsxs("span",{className:"font-medium",children:[p.quantity," x"]})," ",p.partName,e.jsxs("span",{className:"text-slate-400 ml-1",children:["(",W(p.unitPrice||0),")"]})]},p.id)),T&&e.jsx("button",{onClick:()=>B(w.receiptCode),className:"text-xs text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 font-medium mt-1 flex items-center gap-1",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Thu g·ªçn"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Xem th√™m (",w.items.length-U," ","s·∫£n ph·∫©m)"]})})]})})()})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"T·ªïng ti·ªÅn:"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-white",children:W(w.total)}),D?e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:["ƒê√£ tr·∫£: ",W(L)]}),e.jsxs("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",W(P)]}),e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",children:"‚ö†Ô∏è C√≤n n·ª£"})]}):e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"‚úì ƒê√£ thanh to√°n"})})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("button",{onClick:()=>a({...w,date:new Date(w.date)}),className:"p-1.5 text-blue-400 hover:bg-blue-500/20 rounded transition-colors",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})]})]},w.receiptCode)})]}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Hi·ªÉn th·ªã ",g.length," phi·∫øu nh·∫≠p"]})}),s&&e.jsx(_n,{receipt:s,onClose:()=>a(null),onSave:async w=>{var C,_,S,M,L,P,D,$,z;try{const H=new Set(s.items.map(Y=>Y.id)),te=new Set(w.items.filter(Y=>!Y.id.startsWith("new-")).map(Y=>Y.id)),ce=Array.from(H).filter(Y=>!te.has(Y));for(const Y of ce){const ee=s.items.find(p=>p.id===Y);if(!ee)continue;const{data:U,error:ue}=await he.from("parts").select("stock").eq("id",ee.partId).single();if(ue)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${ue.message}`);if(U){const A=(((C=U.stock)==null?void 0:C[n])||0)-ee.quantity;if(A<0)throw new Error(`Kh√¥ng th·ªÉ x√≥a s·∫£n ph·∫©m "${ee.partName}" v√¨ s·∫Ω l√†m t·ªìn kho √¢m`);const{error:Q}=await he.from("parts").update({stock:{...U.stock,[n]:A}}).eq("id",ee.partId);if(Q)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${Q.message}`)}const{error:T}=await he.from("inventory_transactions").delete().eq("id",Y);if(T)throw new Error(`Kh√¥ng th·ªÉ x√≥a giao d·ªãch: ${T.message}`)}for(const Y of w.items){if(Y.id.startsWith("new-"))continue;const ee=s.items.find(ue=>ue.id===Y.id),{error:U}=await he.from("inventory_transactions").update({quantity:Y.quantity,unitPrice:Y.unitPrice,totalPrice:Y.totalPrice,notes:`NV:${((M=(S=(_=w.items[0].notes)==null?void 0:_.split("NV:")[1])==null?void 0:S.split("NCC:")[0])==null?void 0:M.trim())||"Xu√¢n Nhan"} NCC:${w.supplier}${w.supplierPhone?` Phone:${w.supplierPhone}`:""}`}).eq("id",Y.id);if(U)throw U;if(ee&&ee.quantity!==Y.quantity){const ue=Y.quantity-ee.quantity,{data:T,error:p}=await he.from("parts").select("stock, id").eq("id",ee.partId).single();if(p)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${p.message}`);if(T){const A=((L=T.stock)==null?void 0:L[n])||0,Q=A+ue;if(Q<0)throw new Error(`Kh√¥ng th·ªÉ gi·∫£m s·ªë l∆∞·ª£ng v√¨ s·∫Ω l√†m t·ªìn kho √¢m (hi·ªán c√≥: ${A})`);const{error:oe}=await he.from("parts").update({stock:{...T.stock,[n]:Q}}).eq("id",T.id);if(oe)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${oe.message}`)}}}const de=w.items.filter(Y=>Y.id.startsWith("new-"));for(const Y of de){const{data:ee,error:U}=await he.from("parts").select("stock, id").eq("id",Y.partId).single();if(U)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${U.message}`);if(ee){const p=(((P=ee.stock)==null?void 0:P[n])||0)+Y.quantity,{error:A}=await he.from("parts").update({stock:{...ee.stock,[n]:p}}).eq("id",ee.id);if(A)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${A.message}`)}const{error:ue}=await he.from("inventory_transactions").insert({type:"Nh·∫≠p kho",partId:Y.partId,partName:Y.partName,quantity:Y.quantity,date:s.date.toISOString(),unitPrice:Y.unitPrice,totalPrice:Y.totalPrice,branchId:n,notes:`NV:${((z=($=(D=w.items[0].notes)==null?void 0:D.split("NV:")[1])==null?void 0:$.split("NCC:")[0])==null?void 0:z.trim())||"Xu√¢n Nhan"} NCC:${w.supplier}${w.supplierPhone?` Phone:${w.supplierPhone}`:""}`});if(ue)throw new Error(`Kh√¥ng th·ªÉ t·∫°o giao d·ªãch m·ªõi: ${ue.message}`)}q.success(`ƒê√£ c·∫≠p nh·∫≠t phi·∫øu nh·∫≠p kho (${w.items.length} s·∫£n ph·∫©m)`),f.invalidateQueries({queryKey:["inventoryTransactions"]}),f.invalidateQueries({queryKey:["partsRepo"]}),f.invalidateQueries({queryKey:["partsRepoPaged"]}),a(null)}catch(H){q.error(`L·ªói c·∫≠p nh·∫≠t: ${H.message||"Kh√¥ng r√µ"}`)}},currentBranchId:n})]})},Gn=()=>{var _r;const{currentBranchId:d}=ar(),{mutateAsync:f}=ms(),b=fs(),{data:i=[]}=bs({branchId:d}),[c,m]=y.useState("stock"),[x,h]=y.useState(!1),[l,t]=y.useState(""),[r,s]=y.useState("all"),[a,n]=y.useState("all"),[o,u]=y.useState(!1),[g,k]=y.useState(1),[v,E]=y.useState(20),[O,B]=y.useState([]),[w,C]=y.useState(null),[_,S]=y.useState(!1),[M,L]=y.useState(!1),[P,D]=y.useState(null),[$,z]=y.useState(!1),[H,te]=y.useState(null),[ce,de]=y.useState({top:0,right:0}),Y=j=>{if(!j)return"#94a3b8";let I=0;for(let X=0;X<j.length;X++)I=j.charCodeAt(X)+((I<<5)-I);const V=(I&16777215).toString(16).toUpperCase();return`#${"00000".substring(0,6-V.length)+V}`},{confirm:ee,confirmState:U,handleConfirm:ue,handleCancel:T}=cs(),{data:p,isLoading:A,isError:Q}=Ta({page:g,pageSize:v,search:l,category:r==="all"?void 0:r}),oe=(p==null?void 0:p.data)||[],Ce=((_r=p==null?void 0:p.meta)==null?void 0:_r.total)||0,Me=Math.max(1,Math.ceil(Ce/v)),{data:ie,refetch:Fe}=xt({queryKey:["allPartsForTotals",d,l,r],queryFn:async()=>{console.log("üîÑ Fetching allPartsForTotals...");let j=he.from("parts").select("id, name, sku, category, stock, costPrice, retailPrice").order("name");if(r&&r!=="all"&&(j=j.eq("category",r)),l&&l.trim()){const X=l.trim();j=j.or(`name.ilike.%${X}%,sku.ilike.%${X}%`)}const{data:I,error:V}=await j;if(V)throw V;return console.log(`‚úÖ Fetched ${(I==null?void 0:I.length)||0} parts`),I||[]},staleTime:5e3}),R=y.useMemo(()=>{if(!ie)return{totalProducts:0,inStock:0,lowStock:0,outOfStock:0};const j={totalProducts:ie.length,inStock:0,lowStock:0,outOfStock:0},I=d||"";return ie.forEach(V=>{var le;const X=((le=V.stock)==null?void 0:le[I])||0;X>0&&(j.inStock+=1),X===0&&(j.outOfStock+=1),X>0&&X<=Be&&(j.lowStock+=1)}),j},[ie,d]),re=y.useMemo(()=>[{id:"all",label:"T·∫•t c·∫£",description:"To√†n b·ªô kho",count:R.totalProducts,variant:"neutral"},{id:"in-stock",label:"C√≤n h√†ng",description:"> 0",count:R.inStock,variant:"success"},{id:"low-stock",label:"S·∫Øp h·∫øt",description:`<= ${Be}`,count:R.lowStock,variant:"warning"},{id:"out-of-stock",label:"H·∫øt h√†ng",description:"= 0",count:R.outOfStock,variant:"danger"}],[R]),J=y.useMemo(()=>{if(!ie)return new Set;const j=new Map;ie.forEach(V=>{if(!V.sku)return;const X=j.get(V.sku)||0;j.set(V.sku,X+1)});const I=new Set(Array.from(j.entries()).filter(([V,X])=>X>1).map(([V,X])=>V));return console.log(`üîç Detected ${I.size} duplicate product SKUs from ${ie.length} parts`),I.size>0&&console.log("Duplicate SKUs:",Array.from(I).slice(0,5)),I},[ie]),se=y.useCallback(j=>J.has(j),[J]),{data:be}=xt({queryKey:["duplicateParts",d,Array.from(J)],queryFn:async()=>{if(J.size===0)return[];console.log(`üîç Fetching all duplicate parts for ${J.size} SKUs...`);const{data:j,error:I}=await he.from("parts").select("*").in("sku",Array.from(J)).order("sku");if(I)throw I;return console.log(`‚úÖ Found ${(j==null?void 0:j.length)||0} parts with duplicate SKUs`),j||[]},enabled:o&&J.size>0,staleTime:5e3}),N=y.useMemo(()=>{const j=o&&J.size>0?be||[]:oe;if(a==="all")return j;const I=d||"";return j.filter(V=>{var le;const X=((le=V.stock)==null?void 0:le[I])||0;return a==="in-stock"?X>0:a==="low-stock"?X>0&&X<=Be:a==="out-of-stock"?X===0:!0})},[oe,o,J,be,a,d]);y.useEffect(()=>{o&&J.size===0&&u(!1)},[o,J.size]);const G=y.useMemo(()=>ie?ie.reduce((j,I)=>{var V;return j+(((V=I.stock)==null?void 0:V[d])||0)},0):0,[ie,d]),Z=y.useMemo(()=>ie?ie.reduce((j,I)=>{var le,we;const V=((le=I.stock)==null?void 0:le[d])||0,X=((we=I.costPrice)==null?void 0:we[d])||0;return j+V*X},0):0,[ie,d]),K=pr(),ae=ls();vr();const ne=os(),{data:ge=[]}=kr(),{profile:pe}=Aa(),ve=y.useCallback(async(j,I,V,X,le)=>{const we=new Date,Te=we.toISOString().split("T")[0].replace(/-/g,""),Pe=`NH-${Te}-${Math.floor(Math.random()*1e3).toString().padStart(3,"0")}`;console.log("üì¶ Saving goods receipt:",{receiptCode:Pe,supplierId:I,totalAmount:V,paymentInfo:le,itemCount:j.length});const{data:Ae}=await he.from("suppliers").select("name").eq("id",I).single(),Re=(Ae==null?void 0:Ae.name)||"Kh√¥ng x√°c ƒë·ªãnh",$e=(le==null?void 0:le.paidAmount)||0,Ie=V-$e;try{if(await b.mutateAsync({items:j.map(xe=>({partId:xe.partId,partName:xe.partName,quantity:xe.quantity,importPrice:xe.importPrice,sellingPrice:xe.sellingPrice,wholesalePrice:xe.wholesalePrice||0})),supplierId:I,branchId:d,userId:(pe==null?void 0:pe.id)||"unknown",notes:`${Pe} | NCC: ${Re}${X?" | "+X:""}`}),Ie>0&&le){const xe=`DEBT-${Te}-${Math.random().toString(36).substring(2,5).toUpperCase()}`,{error:Le}=await he.from("supplier_debts").insert({id:xe,supplier_id:I,supplier_name:Re,branch_id:d,total_amount:Ie,paid_amount:0,remaining_amount:Ie,description:`Nh·∫≠p kho ${Pe} - Thanh to√°n ${$e.toLocaleString()}/${V.toLocaleString()} ƒë`,created_date:we.toISOString().split("T")[0],created_at:we.toISOString()});Le?(console.error("‚ùå Error creating debt:",Le),q.error("L·ªói t·∫°o c√¥ng n·ª£: "+Le.message)):console.log(`‚úÖ Created supplier debt: ${Ie.toLocaleString()} ƒë`)}h(!1),q.success(`Nh·∫≠p kho th√†nh c√¥ng! M√£ phi·∫øu: ${Pe}`),mr((pe==null?void 0:pe.id)||null,{action:"inventory.receipt",tableName:"inventory_transactions",oldData:null,newData:{receiptCode:Pe,supplierId:I,supplierName:Re,items:j.map(xe=>({partId:xe.partId,quantity:xe.quantity,importPrice:xe.importPrice,sellingPrice:xe.sellingPrice})),totalAmount:V,paidAmount:$e,debtAmount:Ie,paymentInfo:le}})}catch(xe){console.error("üõë L·ªói l∆∞u phi·∫øu nh·∫≠p kho:",xe),q.error(`L·ªói: ${xe.message||"Kh√¥ng r√µ"}`)}},[ie,d,ae,f,pe==null?void 0:pe.id]),Wa=j=>{B(j?N.map(I=>I.id):[])},Qa=(j,I)=>{B(I?[...O,j]:O.filter(V=>V!==j))},jr=async j=>{const I=oe.find(X=>X.id===j);!I||!await ee({title:"X√°c nh·∫≠n x√≥a",message:`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m "${I.name}"?`,confirmText:"X√≥a",cancelText:"H·ªßy",confirmColor:"red"})||ne.mutate({id:j},{onSuccess:async()=>{B(X=>X.filter(le=>le!==j)),await Fe(),console.log("üîÑ Refetched allPartsForTotals after delete"),q.success(`ƒê√£ x√≥a ph·ª• t√πng "${I.name}"`)},onError:X=>{console.error("Delete error:",X),q.error(`Kh√¥ng th·ªÉ x√≥a: ${X.message}`)}})},Ya=async()=>{if(O.length===0){q.warning("Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m");return}if(!await ee({title:"X√°c nh·∫≠n x√≥a",message:`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ${O.length} s·∫£n ph·∫©m ƒë√£ ch·ªçn? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.`,confirmText:"X√≥a",cancelText:"H·ªßy",confirmColor:"red"}))return;let I=0,V=0;const X=O.length;O.forEach((le,we)=>{ne.mutate({id:le},{onSuccess:async()=>{I++,I+V===X&&(await Fe(),console.log("üîÑ Refetched allPartsForTotals after bulk delete"),V===0?q.success(`ƒê√£ x√≥a ${I} ph·ª• t√πng`):q.warning(`ƒê√£ x√≥a ${I}/${X} ph·ª• t√πng (${V} l·ªói)`))},onError:Te=>{console.error(`Delete error for item ${le}:`,Te),V++,I+V===X&&(I===0?q.error(`Kh√¥ng th·ªÉ x√≥a ${X} ph·ª• t√πng`):q.warning(`ƒê√£ x√≥a ${I}/${X} ph·ª• t√πng (${V} l·ªói)`))}})}),B([])},or=j=>{k(1),n(j)},Ja=j=>{k(1),s(j)},Za=R.lowStock>0&&a!=="low-stock";R.totalProducts>0&&Math.round(R.lowStock/R.totalProducts*100);const wr=()=>{try{const j=new Date,I=`ton-kho-${j.getDate()}-${j.getMonth()+1}-${j.getFullYear()}.xlsx`;js(oe,d,I),q.success("Xu·∫•t file Excel th√†nh c√¥ng!")}catch(j){console.error("Export error:",j),q.error("C√≥ l·ªói khi xu·∫•t file Excel")}},Nr=()=>{try{ws(),q.success("T·∫£i template th√†nh c√¥ng! Vui l√≤ng ƒëi·ªÅn th√¥ng tin v√† import l·∫°i.")}catch(j){console.error("Template download error:",j),q.error("C√≥ l·ªói khi t·∫£i template")}};return y.useEffect(()=>{if(typeof document>"u")return;const j=()=>te(null);return document.addEventListener("click",j),()=>document.removeEventListener("click",j)},[]),e.jsxs("div",{className:"h-full flex flex-col bg-slate-50 dark:bg-slate-900 sm:bg-[#1e293b]",children:[e.jsx("div",{className:"hidden sm:block bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-3 py-1.5",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"flex gap-1",children:[{key:"stock",label:"T·ªìn kho",icon:e.jsx(ir,{className:"w-3.5 h-3.5"})},{key:"categories",label:"Danh m·ª•c",icon:e.jsx(er,{className:"w-3.5 h-3.5"})},{key:"lookup",label:"Tra c·ª©u",icon:e.jsx(ct,{className:"w-3.5 h-3.5"})},{key:"history",label:"L·ªãch s·ª≠",icon:e.jsx(dr,{className:"w-3.5 h-3.5"})}].map(j=>e.jsx("button",{onClick:()=>m(j.key),className:`px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors ${c===j.key?"bg-blue-600 text-white":"text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:bg-slate-700"}`,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[j.icon,j.label]})},j.key))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg bg-emerald-600 text-white text-xs font-medium hover:bg-emerald-700 transition",title:"In m√£ v·∫°ch h√†ng lo·∫°t",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"In m√£ v·∫°ch"]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 transition",children:[e.jsx(tr,{className:"w-3.5 h-3.5"}),"T·∫°o phi·∫øu nh·∫≠p"]}),e.jsxs("div",{className:"flex items-center gap-0.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-100 dark:bg-slate-700 px-1 py-0.5",children:[e.jsx("button",{onClick:()=>{q.info("T√≠nh nƒÉng chuy·ªÉn kho ƒëang ph√°t tri·ªÉn")},className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-blue-600 hover:bg-white dark:bg-slate-800 transition",title:"Chuy·ªÉn kho",children:e.jsx(Or,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:wr,className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-emerald-600 hover:bg-white dark:bg-slate-800 transition",title:"Xu·∫•t Excel",children:e.jsx(vs,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>S(!0),className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-blue-600 hover:bg-white dark:bg-slate-800 transition",title:"Nh·∫≠p CSV",children:e.jsx(ps,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:Nr,className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-amber-600 hover:bg-white dark:bg-slate-800 transition",title:"T·∫£i m·∫´u import",children:e.jsx(dr,{className:"w-3.5 h-3.5"})})]})]})]})}),e.jsxs("div",{className:"sm:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-3 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm theo t√™n ho·∫∑c SKU...",value:l,onChange:j=>{k(1),t(j.target.value)},className:"w-full pl-10 pr-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-1.5 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition whitespace-nowrap",children:[e.jsx(tr,{className:"w-4 h-4"}),"T·∫°o phi·∫øu"]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"T·ªïng:"}),e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[G.toLocaleString()," sp"]})]}),e.jsx("div",{className:"h-3 w-px bg-slate-300 dark:bg-slate-600"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Gi√° tr·ªã:"}),e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:W(Z)})]})]})})]}),c==="stock"&&e.jsx("div",{className:"hidden sm:block bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-4 py-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-blue-500/20 bg-blue-500/5",children:[e.jsx(ir,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:G.toLocaleString()}),e.jsx("span",{className:"text-[10px] text-slate-600 dark:text-slate-300 ml-1",children:"sp"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-emerald-500/20 bg-emerald-500/5",children:[e.jsx(er,{className:"w-4 h-4 text-emerald-600"}),e.jsx("div",{children:e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:W(Z)})})]})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm theo t√™n ho·∫∑c SKU...",value:l,onChange:j=>{k(1),t(j.target.value)},className:"w-full pl-9 pr-16 py-1.5 text-sm border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] text-slate-600 dark:text-slate-300",children:[N.length,"/",Ce]})]}),e.jsxs("button",{onClick:()=>z(j=>!j),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-lg border transition flex-shrink-0 ${$?"border-blue-500 text-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:text-slate-100"}`,children:[e.jsx(ks,{className:"w-3.5 h-3.5"}),"B·ªô l·ªçc n√¢ng cao"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[re.map(j=>{const I=a===j.id,V={neutral:I?"bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700",success:I?"bg-emerald-600 text-white":"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 hover:bg-emerald-100",warning:I?"bg-amber-600 text-white":"bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 hover:bg-amber-100",danger:I?"bg-red-600 text-white":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 hover:bg-red-100"};return e.jsxs("button",{onClick:()=>or(j.id),className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium transition ${V[j.variant||"neutral"]}`,children:[e.jsx("span",{children:j.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] font-bold ${I?"bg-white/20":"bg-black/10 dark:bg-white/10"}`,children:j.count})]},j.id)}),Za&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[e.jsxs("span",{className:"text-xs",children:["‚ö†Ô∏è ",R.lowStock," s·∫Øp h·∫øt"]}),e.jsx("button",{onClick:()=>or("low-stock"),className:"px-2 py-0.5 rounded text-[10px] font-semibold bg-amber-600 text-white hover:bg-amber-700",children:"L·ªçc"})]})]}),$&&e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 bg-white/70 dark:bg-slate-900/40 p-3 grid gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Tr·∫°ng th√°i t·ªìn kho"}),e.jsxs("select",{value:a,onChange:j=>or(j.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-3 py-1.5 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/40",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ t·ªìn kho"}),e.jsx("option",{value:"in-stock",children:"C√≤n h√†ng"}),e.jsx("option",{value:"low-stock",children:"S·∫Øp h·∫øt"}),e.jsx("option",{value:"out-of-stock",children:"H·∫øt h√†ng"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Danh m·ª•c"}),e.jsxs("select",{value:r,onChange:j=>Ja(j.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-3 py-1.5 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/40",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),ge.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsxs("div",{className:"flex flex-col justify-end",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Ph√°t hi·ªán tr√πng m√£"}),e.jsx("button",{onClick:()=>u(j=>!j),className:`mt-1 rounded-lg border px-3 py-1.5 text-sm font-medium transition ${o?"border-orange-500 text-orange-600 bg-orange-50 dark:bg-orange-900/20":"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:text-slate-100"}`,children:o?"ƒêang l·ªçc tr√πng m√£":"L·ªçc tr√πng m√£"})]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 sm:p-3",children:[c==="stock"&&e.jsxs("div",{className:"space-y-2",children:[J.size>0&&e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-500 px-3 py-2 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"‚ö†Ô∏è"}),e.jsxs("span",{className:"text-xs font-semibold text-orange-800 dark:text-orange-300",children:["Ph√°t hi·ªán ",J.size," s·∫£n ph·∫©m tr√πng m√£"]})]}),e.jsx("button",{onClick:()=>u(!o),className:`px-2 py-0.5 rounded text-[10px] font-medium transition ${o?"bg-orange-600 text-white":"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300"}`,children:o?"‚úì ƒêang l·ªçc":"üîç L·ªçc"})]}),e.jsxs("div",{className:"rounded-lg overflow-hidden bg-white dark:bg-slate-800",children:[O.length>0&&e.jsxs("div",{className:"px-4 py-2 bg-blue-100 dark:bg-blue-900/30 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:["ƒê√£ ch·ªçn ",O.length," s·∫£n ph·∫©m"]}),e.jsxs("button",{onClick:Ya,className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"X√≥a ƒë√£ ch·ªçn"]})]}),e.jsx("div",{className:"block sm:hidden",children:e.jsx("div",{className:"space-y-3 p-3",children:N.map((j,I)=>{const V=j.stock[d]||0,X=j.retailPrice[d]||0,le=se(j.sku||"");return e.jsx("div",{className:`p-3 rounded-xl bg-[#2d3748] border border-slate-600 transition ${le?"border-l-4 border-l-orange-500":""}`,role:"listitem",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[15px] font-medium text-white leading-tight",children:j.name}),e.jsxs("div",{className:"text-[11px] text-blue-400 mt-1 truncate font-mono",children:["SKU: ",j.sku]}),j.category&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 mt-1.5 rounded-full text-[10px] font-medium ${je(j.category).bg} ${je(j.category).text}`,children:j.category})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("div",{className:"text-[13px] text-emerald-400 font-semibold",children:W(X)})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 text-sm font-bold rounded-lg ${V===0?"text-red-300 bg-red-900/40 border border-red-700/50":V<Be?"text-yellow-300 bg-yellow-900/40 border border-yellow-700/50":"text-emerald-300 bg-emerald-900/40 border border-emerald-700/50"}`,children:[e.jsx("span",{className:"text-xs opacity-80",children:"SL:"}),V]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>D(P===I?null:I),"aria-haspopup":"true","aria-expanded":P===I,"aria-label":"Th√™m h√†nh ƒë·ªông",className:"p-2.5 -m-1 text-slate-400 hover:bg-slate-600 rounded-lg transition active:bg-slate-500",children:e.jsx(Pr,{className:"w-5 h-5"})}),P===I&&e.jsxs("div",{className:"absolute right-0 bottom-full mb-2 w-40 bg-slate-800 border border-slate-700 rounded-lg shadow-xl z-[9999]",children:[e.jsxs("button",{onClick:()=>{C(j),D(null)},className:"w-full text-left px-3 py-2.5 text-sm hover:bg-slate-700 flex items-center gap-2 text-white rounded-t-lg","aria-label":`Ch·ªânh s·ª≠a ${j.name}`,children:[e.jsx(Mr,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{children:"Ch·ªânh s·ª≠a"})]}),e.jsxs("button",{onClick:()=>{jr(j.id),D(null)},className:"w-full text-left px-3 py-2.5 text-sm hover:bg-slate-700 flex items-center gap-2 text-red-400 rounded-b-lg","aria-label":`X√≥a ${j.name}`,children:[e.jsx(Cr,{className:"w-4 h-4"}),e.jsx("span",{children:"X√≥a"})]})]})]})]})]})},j.id)})})}),e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700/50",children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-600 text-[10px] font-semibold uppercase tracking-wider text-slate-600 dark:text-slate-300",children:[e.jsx("th",{className:"px-3 py-2.5 text-center w-10",children:e.jsx("input",{type:"checkbox",checked:O.length===N.length&&N.length>0,onChange:j=>Wa(j.target.checked),className:"w-3.5 h-3.5 text-blue-600 rounded border-slate-300 dark:border-slate-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-3 py-2.5 text-left",children:"S·∫£n ph·∫©m"}),e.jsx("th",{className:"px-3 py-2.5 text-center",children:"T·ªìn kho"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° nh·∫≠p"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° b√°n l·∫ª"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° b√°n s·ªâ"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° tr·ªã t·ªìn"}),e.jsx("th",{className:"px-3 py-2.5 text-center w-14",children:"H√†nh ƒë·ªông"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-100 dark:divide-slate-700",children:N.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:8,className:"px-4 py-6 text-center text-slate-400 dark:text-slate-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"üóÇÔ∏è"}),e.jsx("div",{className:"text-sm",children:"Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o"}),e.jsx("div",{className:"text-xs",children:"H√£y th·ª≠ m·ªôt b·ªô l·ªçc kh√°c ho·∫∑c th√™m s·∫£n ph·∫©m m·ªõi"})]})}):N.map(j=>{var He,at,Ke,Xe,We,Qe;const I=d||"",V=((He=j.stock)==null?void 0:He[I])||0,X=((at=j.retailPrice)==null?void 0:at[I])||0,le=((Ke=j.wholesalePrice)==null?void 0:Ke[I])||0,we=((Xe=j.costPrice)==null?void 0:Xe[I])||0,Te=V*X,Pe=O.includes(j.id),Ae=se(j.sku||""),Re=V===0?"border-red-300 bg-red-50 text-red-700 dark:border-red-700 dark:bg-red-950/50 dark:text-red-300":V<=Be?"border-amber-300 bg-amber-50 text-amber-700 dark:border-amber-600 dark:bg-amber-950/50 dark:text-amber-300":"border-emerald-300 bg-emerald-50 text-emerald-700 dark:border-emerald-600 dark:bg-emerald-950/50 dark:text-emerald-300",$e=V===0?"H·∫øt h√†ng":V<=Be?"S·∫Øp h·∫øt":"·ªîn ƒë·ªãnh",Ie=V===0?"text-red-600 dark:text-red-400":V<=Be?"text-amber-600 dark:text-amber-400":"text-emerald-700 dark:text-emerald-400",xe=((Qe=(We=j.name)==null?void 0:We.charAt(0))==null?void 0:Qe.toUpperCase())||"?",Le=Pe?"bg-blue-900/20 dark:bg-blue-900/20":Ae?"bg-orange-500/10 border-l-4 border-l-orange-500":"";return e.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${Le}`,children:[e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:Pe,onChange:ye=>Qa(j.id,ye.target.checked),className:"w-3.5 h-3.5 text-blue-600 rounded border-slate-300 dark:border-slate-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-2 min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg overflow-hidden flex items-center justify-center text-sm font-semibold text-white flex-shrink-0",style:j.imageUrl?void 0:{backgroundColor:Y(j.category)},children:j.imageUrl?e.jsx("img",{src:j.imageUrl,alt:j.name,className:"h-full w-full object-cover"}):e.jsx("span",{children:xe})}),e.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold text-slate-900 dark:text-slate-100 truncate",children:[j.name,Ae&&e.jsx("span",{className:"inline-flex items-center gap-0.5 rounded-full border border-orange-300 bg-orange-50 px-1.5 py-0 text-[9px] font-semibold text-orange-700 dark:bg-orange-900/30 flex-shrink-0",title:"S·∫£n ph·∫©m c√≥ m√£ tr√πng l·∫∑p",children:"‚ö†Ô∏è Tr√πng"})]}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-mono",children:j.barcode?e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["M√£: ",j.barcode]}):e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["SKU: ",j.sku||"N/A"]})}),j.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0 rounded-full text-[9px] font-medium ${je(j.category).bg} ${je(j.category).text}`,children:j.category})]})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("span",{className:`text-sm font-semibold ${Ie}`,children:V.toLocaleString()}),e.jsxs("span",{className:`inline-flex items-center gap-0.5 rounded-full border px-1.5 py-0 text-[9px] font-semibold ${Re}`,children:[e.jsx("span",{className:`h-1 w-1 rounded-full ${V===0?"bg-red-500":V<=Be?"bg-amber-500":"bg-emerald-500"}`}),$e]})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs text-slate-600 dark:text-slate-300",children:W(we)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs font-medium text-slate-900 dark:text-slate-100",children:W(X)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs text-slate-600 dark:text-slate-300",children:W(le)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs font-semibold text-slate-900 dark:text-slate-100",children:W(Te)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:e.jsxs("div",{className:"relative flex justify-end",children:[e.jsx("button",{onClick:ye=>{ye.stopPropagation();const F=ye.currentTarget.getBoundingClientRect();de({top:F.bottom+4,right:window.innerWidth-F.right}),te(me=>me===j.id?null:j.id)},className:"rounded-full border border-transparent p-2 text-slate-600 dark:text-slate-300 hover:border-slate-300 dark:border-slate-600 hover:text-slate-900 dark:text-slate-100 transition","aria-haspopup":"menu","aria-expanded":H===j.id,title:"Thao t√°c nhanh",children:e.jsx(Pr,{className:"w-5 h-5"})}),H===j.id&&e.jsxs("div",{className:"fixed w-44 overflow-hidden rounded-xl border border-slate-200 dark:border-slate-700 bg-white shadow-xl dark:bg-slate-800 z-[9999]",style:{top:ce.top,right:ce.right},onClick:ye=>ye.stopPropagation(),children:[e.jsxs("button",{onClick:ye=>{ye.stopPropagation(),C(j),te(null)},className:"flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm hover:bg-blue-50 dark:hover:bg-slate-700 rounded-t-xl",children:[e.jsx(Mr,{className:"h-4 w-4 text-blue-500"}),"Ch·ªânh s·ª≠a"]}),e.jsxs("button",{onClick:ye=>{ye.stopPropagation(),te(null),jr(j.id)},className:"flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm text-red-500 hover:bg-red-50 dark:hover:bg-slate-700/70 rounded-b-xl",children:[e.jsx(Cr,{className:"h-4 w-4"}),"X√≥a"]})]})]})})]},j.id)})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-3 sm:px-6 py-3 sm:py-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-300 text-center sm:text-left",children:[e.jsxs("span",{className:"font-medium",children:["Trang ",g,"/",Me]}),e.jsx("span",{className:"mx-1",children:"‚Ä¢"}),e.jsxs("span",{children:[Ce," ph·ª• t√πng"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("button",{disabled:g===1||A,onClick:()=>k(j=>Math.max(1,j-1)),className:"px-2.5 sm:px-3 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded disabled:opacity-40 hover:bg-slate-700/50 transition-colors",children:"‚Üê"}),e.jsx("span",{className:"px-2 py-1 text-xs sm:text-sm font-medium text-slate-300 min-w-[2rem] text-center",children:g}),e.jsx("button",{disabled:g>=Me||A,onClick:()=>k(j=>Math.min(Me,j+1)),className:"px-2.5 sm:px-3 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded disabled:opacity-40 hover:bg-slate-700/50 transition-colors",children:"‚Üí"}),e.jsx("select",{value:v,onChange:j=>{const I=Number(j.target.value)||20;E(I),k(1)},className:"px-1.5 sm:px-2 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded bg-slate-800 text-slate-200",children:[10,20,50,100].map(j=>e.jsx("option",{value:j,children:j},j))})]})]})]})]}),c==="history"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(Sn,{transactions:i})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(Ms,{transactions:i})})]}),c==="categories"&&e.jsx("div",{className:"bg-[#0f172a] -m-3 sm:-m-6",children:e.jsx(us,{})}),c==="lookup"&&e.jsxs("div",{className:"bg-[#0f172a] -m-3 sm:-m-6",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(xs,{})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(_s,{})})]})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(jn,{isOpen:x,onClose:()=>h(!1),parts:ie||[],currentBranchId:d,onSave:ve})}),e.jsx(yn,{isOpen:x,onClose:()=>h(!1),parts:ie||[],currentBranchId:d,onSave:ve}),M&&e.jsx(kn,{parts:ie||[],currentBranchId:d,onClose:()=>L(!1)}),w&&e.jsx(En,{part:w,onClose:()=>C(null),onSave:j=>{console.log("üíæ Saving part updates:",j);const I={name:j.name,barcode:j.barcode,category:j.category,stock:j.stock,retailPrice:j.retailPrice,wholesalePrice:j.wholesalePrice};j.costPrice&&(I.costPrice=j.costPrice),console.log("üì§ Sending updates:",I),ae.mutate({id:j.id,updates:I}),C(null)},currentBranchId:d}),_&&e.jsx(Cn,{onClose:()=>S(!1),onDownloadTemplate:Nr,onImport:async j=>{var I,V;try{const{items:X,errors:le}=await Ns(j,d);if(X.length===0){const F=le.length?`Kh√¥ng import ƒë∆∞·ª£c: ${le.slice(0,3).join("; ")}`:"File kh√¥ng c√≥ d·ªØ li·ªáu h·ª£p l·ªá";throw new Error(F)}const we=X.map(F=>F.sku);console.log(`üîç Checking ${we.length} SKUs...`);const Te=new Map;we.forEach(F=>{Te.set(F,(Te.get(F)||0)+1)});const Pe=Array.from(Te.entries()).filter(([F,me])=>me>1).map(([F,me])=>`${F}(${me}x)`);Pe.length>0&&console.warn(`‚ö†Ô∏è Duplicate SKUs in file: ${Pe.slice(0,5).join(", ")}`);const Ae=Array.from(new Set(we)),Re=100,$e=[];for(let F=0;F<Ae.length;F+=Re){const me=Ae.slice(F,F+Re),{data:Ee,error:Ye}=await he.from("parts").select("*").in("sku",me);if(Ye)throw console.error(`‚ùå Fetch chunk ${F/Re+1} error:`,Ye),new Error(`L·ªói ki·ªÉm tra ph·ª• t√πng: ${Ye.message}`);Ee&&$e.push(...Ee)}console.log(`‚úÖ Found ${$e.length} existing parts`);const Ie=new Map($e.map(F=>[F.sku,F])),xe=[],Le=[],He=[],at=new Set;let Ke=0,Xe=0,We=0;const Qe=new Date().toISOString();for(const F of X){if(at.has(F.sku)){console.warn(`‚ö†Ô∏è Skipping duplicate SKU in file: ${F.sku}`),We++;continue}at.add(F.sku);const me=Ie.get(F.sku);if(me)Xe+=1,Le.push({id:me.id,stock:{...me.stock,[d]:(me.stock[d]||0)+F.quantity},costPrice:{...me.costPrice,[d]:F.costPrice},retailPrice:{...me.retailPrice,[d]:F.retailPrice},wholesalePrice:{...me.wholesalePrice,[d]:F.wholesalePrice}}),He.push({type:"Nh·∫≠p kho",date:Qe,branchId:d,partId:me.id,partName:F.name,quantity:F.quantity,unitPrice:F.retailPrice,totalPrice:F.quantity*F.retailPrice,notes:"Nh·∫≠p kho t·ª´ file Excel"});else{Ke+=1;const Ee=((I=crypto==null?void 0:crypto.randomUUID)==null?void 0:I.call(crypto))||`${Math.random().toString(36).slice(2)}-${Date.now()}`;xe.push({id:Ee,name:F.name,sku:F.sku,category:F.category,description:F.description,stock:{[d]:F.quantity},costPrice:{[d]:F.costPrice},retailPrice:{[d]:F.retailPrice},wholesalePrice:{[d]:F.wholesalePrice}}),He.push({type:"Nh·∫≠p kho",date:Qe,branchId:d,partId:Ee,partName:F.name,quantity:F.quantity,unitPrice:F.retailPrice,totalPrice:F.quantity*F.retailPrice,notes:"Nh·∫≠p kho t·ª´ file Excel"})}}if(xe.length>0){const{data:F,error:me}=await he.from("parts").insert(xe).select();if(me)throw console.error("‚ùå Batch create error:",me),new Error(`L·ªói t·∫°o ph·ª• t√πng: ${me.message}`);console.log(`‚úÖ Created ${(F==null?void 0:F.length)||0} parts`)}if(Le.length>0){let F=0,me=0;for(const Ee of Le){const{error:Ye}=await he.from("parts").update({stock:Ee.stock,costPrice:Ee.costPrice,retailPrice:Ee.retailPrice,wholesalePrice:Ee.wholesalePrice}).eq("id",Ee.id);Ye?(console.error(`‚ùå Update error for part ${Ee.id}:`,Ye),me++):F++}console.log(`‚úÖ Updated ${F}/${Le.length} parts`)}if(He.length>0){const{error:F}=await he.from("inventory_transactions").insert(He);F&&console.warn("‚ö†Ô∏è Inventory transactions error:",F)}K.invalidateQueries({queryKey:["partsRepo"]}),K.invalidateQueries({queryKey:["partsRepoPaged"]});try{const{data:F}=await he.auth.getUser();await mr(((V=F==null?void 0:F.user)==null?void 0:V.id)||null,{action:"inventory.import",tableName:"inventory_transactions",oldData:null,newData:{totalRows:X.length+le.length,created:Ke,updated:Xe,skipped:le.length,sampleErrors:le.slice(0,10),branchId:d,at:Qe}})}catch{}S(!1);let ye=`Import: t·∫°o m·ªõi ${Ke}, c·∫≠p nh·∫≠t ${Xe}`;We>0&&(ye+=`, b·ªè qua ${We} SKU tr√πng`),le.length>0&&(ye+=`, ${le.length} d√≤ng l·ªói`),q.success(ye)}catch(X){console.error("‚ùå Import error:",X),q.error(`L·ªói import: ${X}`)}}}),e.jsx(hs,{isOpen:U.isOpen,title:U.title,message:U.message,confirmText:U.confirmText,cancelText:U.cancelText,confirmColor:U.confirmColor,onConfirm:ue,onCancel:T}),e.jsxs("div",{className:"sm:hidden fixed bottom-20 right-4 z-40 flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>h(!0),className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-full shadow-lg shadow-green-500/30 flex items-center justify-center transition-all transform hover:scale-110 active:scale-95","aria-label":"T·∫°o phi·∫øu nh·∫≠p",children:e.jsx(tr,{className:"w-5 h-5"})}),e.jsx("button",{onClick:wr,className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white rounded-full shadow-lg shadow-orange-500/30 flex items-center justify-center transition-all transform hover:scale-110 active:scale-95","aria-label":"Xu·∫•t Excel",children:e.jsx(Or,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 z-50 safe-area-bottom",children:[e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg -z-10"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 px-2 py-2",children:[e.jsxs("button",{onClick:()=>m("stock"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="stock"?"bg-amber-100 dark:bg-amber-900/40 text-amber-600 dark:text-amber-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(ir,{className:`w-5 h-5 ${c==="stock"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="stock"?"font-semibold":""}`,children:"T·ªìn kho"})]}),e.jsxs("button",{onClick:()=>m("categories"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="categories"?"bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(er,{className:`w-5 h-5 ${c==="categories"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="categories"?"font-semibold":""}`,children:"Danh m·ª•c"})]}),e.jsxs("button",{onClick:()=>m("lookup"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="lookup"?"bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(ct,{className:`w-5 h-5 ${c==="lookup"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="lookup"?"font-semibold":""}`,children:"Tra c·ª©u"})]}),e.jsxs("button",{onClick:()=>m("history"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="history"?"bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(dr,{className:`w-5 h-5 ${c==="history"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="history"?"font-semibold":""}`,children:"L·ªãch s·ª≠"})]})]})]})]})},Cn=({onClose:d,onDownloadTemplate:f,onImport:b})=>{const[i,c]=y.useState(null),[m,x]=y.useState(!1),h=t=>{var s,a;const r=(s=t.target.files)==null?void 0:s[0];if(r){const n=(a=r.name.split(".").pop())==null?void 0:a.toLowerCase();n==="xlsx"||n==="xls"||n==="csv"?c(r):q.warning("Vui l√≤ng ch·ªçn file Excel (.xlsx, .xls) ho·∫∑c CSV (.csv)")}},l=async()=>{if(!i){q.warning("Vui l√≤ng ch·ªçn file ƒë·ªÉ import");return}x(!0);try{await b(i)}finally{x(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Nh·∫≠p t·ªìn kho t·ª´ Excel/CSV"}),e.jsx("button",{onClick:d,disabled:m,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 disabled:opacity-50",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng"}),e.jsxs("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"T·∫£i file template m·∫´u"}),e.jsx("li",{children:"ƒêi·ªÅn th√¥ng tin s·∫£n ph·∫©m v√†o file"}),e.jsx("li",{children:"L∆∞u file v√† ch·ªçn ƒë·ªÉ import"})]}),e.jsx("button",{onClick:f,className:"mt-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:"üì• T·∫£i Template Excel"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ch·ªçn file ƒë·ªÉ import"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:h,disabled:m,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Click ƒë·ªÉ ch·ªçn file Excel ho·∫∑c CSV"}),i&&e.jsxs("span",{className:"mt-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:["‚úì ",i.name]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:d,disabled:m,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors disabled:opacity-50",children:"H·ªßy"}),e.jsx("button",{onClick:l,disabled:!i||m,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?"ƒêang x·ª≠ l√Ω...":"Import"})]})]})]})})},En=({part:d,onClose:f,onSave:b,currentBranchId:i})=>{var u,g;const[c,m]=y.useState({name:d.name,barcode:d.barcode||"",category:d.category||"",retailPrice:d.retailPrice[i]||0,wholesalePrice:((u=d.wholesalePrice)==null?void 0:u[i])||0,costPrice:((g=d.costPrice)==null?void 0:g[i])||0,stock:d.stock[i]||0}),[x,h]=y.useState(!1),{data:l=[]}=kr(),t=Ia(),[r,s]=y.useState(!1),[a,n]=y.useState(""),o=k=>{if(k.preventDefault(),!c.name.trim()){q.warning("Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m");return}b({id:d.id,name:c.name.trim(),barcode:c.barcode.trim()||void 0,category:c.category.trim()||void 0,stock:{...d.stock,[i]:c.stock},costPrice:{...d.costPrice,[i]:c.costPrice},retailPrice:{...d.retailPrice,[i]:c.retailPrice},wholesalePrice:{...d.wholesalePrice,[i]:c.wholesalePrice}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Ch·ªânh s·ª≠a s·∫£n ph·∫©m"}),e.jsx("button",{onClick:f,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["T√™n s·∫£n ph·∫©m ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.name,onChange:k=>m({...c,name:k.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"M√£ s·∫£n ph·∫©m"}),e.jsx("input",{type:"text",value:c.barcode,onChange:k=>m({...c,barcode:k.target.value}),placeholder:"VD: 06455-KYJ-841 (Honda), 5S9-F2101-00 (Yamaha)",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Nh·∫≠p m√£ h√£ng (Honda/Yamaha) ho·∫∑c ƒë·ªÉ tr·ªëng ƒë·ªÉ t·ª± sinh m√£ n·ªôi b·ªô PT-xxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Danh m·ª•c"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:c.category,onChange:k=>m({...c,category:k.target.value}),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"-- Ch·ªçn ho·∫∑c t·∫°o m·ªõi --"}),l.map(k=>e.jsx("option",{value:k.name,children:k.name},k.id))]}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-600",title:"Th√™m danh m·ª•c m·ªõi",children:"+"})]}),r&&e.jsxs("form",{onSubmit:async k=>{k.preventDefault();const v=a.trim();if(!v)return q.warning("Vui l√≤ng nh·∫≠p t√™n danh m·ª•c");try{const E=await t.mutateAsync({name:v});m({...c,category:E.name}),n(""),s(!1)}catch(E){q.error((E==null?void 0:E.message)||"L·ªói t·∫°o danh m·ª•c")}},className:"flex gap-2",children:[e.jsx("input",{autoFocus:!0,type:"text",value:a,onChange:k=>n(k.target.value),placeholder:"Nh·∫≠p t√™n danh m·ª•c m·ªõi",className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-sm text-slate-900 dark:text-slate-100"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"L∆∞u"}),e.jsx("button",{type:"button",onClick:()=>{s(!1),n("")},className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-sm bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-600",children:"H·ªßy"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° nh·∫≠p"}),e.jsx("input",{type:"number",value:c.costPrice||0,onChange:k=>m({...c,costPrice:Number(k.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° b√°n l·∫ª"}),e.jsx("input",{type:"number",value:c.retailPrice,onChange:k=>m({...c,retailPrice:Number(k.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° b√°n s·ªâ"}),e.jsx("input",{type:"number",value:c.wholesalePrice,onChange:k=>m({...c,wholesalePrice:Number(k.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ªìn kho hi·ªán t·∫°i"}),e.jsx("input",{type:"number",value:c.stock,onChange:k=>m({...c,stock:Number(k.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"S·ªë l∆∞·ª£ng t·ªìn kho t·∫°i chi nh√°nh hi·ªán t·∫°i"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("div",{className:"font-medium mb-1",children:"L∆∞u √Ω:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"B·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a tr·ª±c ti·∫øp gi√° nh·∫≠p, gi√° b√°n v√† t·ªìn kho"}),e.jsx("li",{children:'Ho·∫∑c s·ª≠ d·ª•ng "T·∫°o phi·∫øu nh·∫≠p" ƒë·ªÉ ghi nh·∫≠n l·ªãch s·ª≠ nh·∫≠p kho chi ti·∫øt'})]})]})}),e.jsxs("div",{className:"flex justify-between gap-3 pt-4",children:[e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"px-4 py-2 border border-blue-300 dark:border-blue-600 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"In m√£ v·∫°ch"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"L∆∞u thay ƒë·ªïi"})]})]})]}),x&&e.jsx(pn,{part:d,currentBranchId:i,onClose:()=>h(!1)})]})})};export{kn as BatchPrintBarcodeModal,Gn as default};
